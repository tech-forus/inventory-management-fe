import{c as Xe,j as e,X as z,r as h,F as Ge}from"./index-v4UyLoar.js";import{i as T}from"./inventoryService-3mhiX-ga.js";import{l as ne}from"./libraryService-BqxRzzIS.js";import{s as de}from"./skuService-CD47JNeC.js";import{F as We}from"./filter-B2wwtLHs.js";import{a as ve,f as g}from"./formatters-ptPrPoGe.js";import{C as fe}from"./chevron-down-DTzR0Snc.js";import{S as Ze}from"./send-BAt3YUnw.js";import{P as Ne}from"./package-hjcnhoIe.js";import{T as De}from"./trash-2-F_yzDzD4.js";import{H as we}from"./history-CzvNXcID.js";import{A as et}from"./alert-circle-DtAct9_U.js";import{D as tt}from"./download-WG4FeSf0.js";import"./api-VNhYhLPD.js";import"./cachedApi-CKq13PPM.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=Xe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),at=({search:s,dateFrom:t,dateTo:p,showFilters:c,onSearchChange:d,onDateFromChange:o,onDateToChange:x,onToggleFilters:y,onClearFilters:a,onApplyFilters:l})=>e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:y,className:`px-4 py-2 rounded-lg border transition-colors ${c?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(We,{className:"w-4 h-4 inline mr-2"}),"Filters"]})})}),c&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsx("button",{onClick:a,className:"text-sm text-gray-600 hover:text-gray-900",children:"Clear All"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsx("input",{type:"text",value:s,onChange:f=>d(f.target.value),placeholder:"Report No., SKU, Item Name, Invoice...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inspection Date From"}),e.jsx("input",{type:"date",value:t,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inspection Date To"}),e.jsx("input",{type:"date",value:p,onChange:f=>x(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Apply Filters"})})]})]}),rt=({report:s,isOpen:t,onToggle:p,onSendToVendor:c,onReceiveFromVendor:d,onScrap:o,onViewHistory:x,dropdownRef:y})=>e.jsxs("div",{className:"relative inline-block",ref:y,children:[e.jsxs("button",{onClick:p,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-700 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",title:"Actions",children:["Actions",e.jsx(fe,{className:`w-4 h-4 ml-1 transition-transform ${t?"rotate-180":""}`})]}),t&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>c(s),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Send to Vendor"]}),e.jsxs("button",{onClick:()=>d(s),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Receive from Vendor"]}),e.jsxs("button",{onClick:()=>o(s),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),"Scrap"]}),e.jsxs("button",{onClick:()=>x(s),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"View History"]})]})})]}),nt=s=>{const t=s.quantity||0,p=s.sentToVendor||0,c=s.receivedBack||0,d=s.scrapped||0,o=p+c+d;return t===0?{status:"Pending",color:"bg-yellow-100 text-yellow-800",description:"No action taken yet on rejected items"}:d===t&&p===0&&c===0?{status:"Scrapped",color:"bg-gray-100 text-gray-800",description:"All rejected items have been scrapped/written off"}:p===t&&c===0&&d===0?{status:"Sent to Vendor",color:"bg-purple-100 text-purple-800",description:"All rejected items have been sent back to vendor, awaiting return"}:c===t&&d===0?{status:"Received",color:"bg-green-100 text-green-800",description:"All rejected items received back and added to stock"}:p>0&&c===p&&d===0?{status:"Completed",color:"bg-green-100 text-green-800",description:"All sent items received back and added to stock"}:p>0&&c>0&&c<p?{status:"Partially Returned",color:"bg-orange-100 text-orange-800",description:"Some (but not all) sent items have been received back from vendor"}:o>0&&o<t?{status:"In Progress",color:"bg-blue-100 text-blue-800",description:"Some items sent to vendor OR some scrapped, but not all"}:{status:"Pending",color:"bg-yellow-100 text-yellow-800",description:"No action taken yet on rejected items"}},dt=({report:s})=>{const t=nt(s);return e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.color}`,children:t.status})},lt=({reports:s,loading:t,openDropdownId:p,dropdownRefs:c,onToggleDropdown:d,onSendToVendor:o,onReceiveFromVendor:x,onScrap:y,onViewHistory:a})=>t?e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading rejected item reports..."})]})}):s.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No rejected item reports found"})})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Report No."}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Inspection Date"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rejected Qty"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sent to Vendor"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Received Back"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scrapped"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Rejected"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(l=>{const f=l.sentToVendor||0,m=l.receivedBack||0,B=l.scrapped||0,Y=l.netRejected!==void 0?l.netRejected:l.quantity-f-m-B;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:l.reportNumber}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:ve(l.inspectionDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:l.skuCode||`SKU-${l.skuId}`}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate text-center",children:l.itemName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 text-center font-bold",children:g(l.quantity)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center",children:g(f)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center",children:g(m)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center",children:g(B)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 text-center font-bold",children:g(Y)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(dt,{report:l})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(rt,{report:l,isOpen:p===l.id,onToggle:()=>d(l.id),onSendToVendor:o,onReceiveFromVendor:x,onScrap:y,onViewHistory:a,dropdownRef:S=>{c.current[l.id]=S}})})]},l.id)})})]})})}),it=({report:s,isOpen:t,onToggle:p,onReceiveBack:c,onViewHistory:d,dropdownRef:o})=>e.jsxs("div",{className:"relative inline-block",ref:o,children:[e.jsxs("button",{onClick:p,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-700 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",title:"Actions",children:["Actions",e.jsx(fe,{className:`w-4 h-4 ml-1 transition-transform ${t?"rotate-180":""}`})]}),t&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>c(s),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Receive Back"]}),e.jsxs("button",{onClick:()=>d(s),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"View History"]})]})})]}),ct=({reports:s,loading:t,openDropdownId:p,dropdownRefs:c,onToggleDropdown:d,onReceiveBack:o,onViewHistory:x})=>{if(t)return e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading short item reports..."})]})});if(s.length===0)return e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No short item reports found"})})});const y=a=>{const l=(a==null?void 0:a.toLowerCase())||"pending",f={pending:{bg:"bg-yellow-100",text:"text-yellow-800"},"received-back":{bg:"bg-green-100",text:"text-green-800"},"partially-received":{bg:"bg-blue-100",text:"text-blue-800"},closed:{bg:"bg-gray-100",text:"text-gray-800"}},m=f[l]||f.pending;return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m.bg} ${m.text}`,children:a.replace(/-/g," ").replace(/\b\w/g,B=>B.toUpperCase())})};return e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice Number"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice Received Date"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU Number"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item Name"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Short Quantity"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Received Back"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Rejected"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(a=>{const l=a.receivedBack||0,f=a.netRejected!==void 0?a.netRejected:a.shortQuantity-l;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:a.invoiceNumber}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:ve(a.invoiceReceivedDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:a.skuCode||`SKU-${a.skuId}`}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate text-center",children:a.itemName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600 text-center font-bold",children:g(a.shortQuantity)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-center",children:g(l)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600 text-center font-bold",children:g(f)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:y(a.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(it,{report:a,isOpen:p===a.id,onToggle:()=>d(a.id),onReceiveBack:o,onViewHistory:x,dropdownRef:m=>{c.current[a.id]=m}})})]},a.id)})})]})})})},ot=({report:s,formData:t,vendors:p,brands:c,processing:d,onClose:o,onFormChange:x,onSubmit:y})=>{s.quantity-(s.sentToVendor||0)-(s.receivedBack||0)-(s.scrapped||0);const a=s.quantity-(s.sentToVendor||0)-(s.receivedBack||0)-(s.scrapped||0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Send to Vendor"}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",disabled:d,children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Item:"})," ",e.jsxs("span",{className:"text-gray-900",children:[s.itemName," (",s.skuCode||`SKU-${s.skuId}`,")"]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.vendorId,onChange:l=>x({vendorId:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Vendor"}),p.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Brand ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.brandId,onChange:l=>x({brandId:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Brand"}),c.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejected Quantity"}),e.jsx("input",{type:"text",value:g(s.quantity),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Already Sent"}),e.jsx("input",{type:"text",value:g(s.sentToVendor||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Send Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",max:a,value:t.quantity,onChange:l=>x({quantity:parseInt(l.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Max: ",g(a)]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Unit Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:t.unitPrice!==void 0?t.unitPrice:"",onChange:l=>x({unitPrice:parseFloat(l.target.value)||0}),placeholder:"Enter unit price",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the unit price for this item"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:t.date,onChange:l=>x({date:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Docket/Tracking"}),e.jsx("input",{type:"text",value:t.docketTracking,onChange:l=>x({docketTracking:l.target.value}),placeholder:"Enter docket or tracking number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transporter"}),e.jsx("input",{type:"text",value:t.transporter,onChange:l=>x({transporter:l.target.value}),placeholder:"Enter transporter name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:t.reason,onChange:l=>x({reason:l.target.value}),placeholder:"Quality defect, wrong specs, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,disabled:d,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.remarks,onChange:l=>x({remarks:l.target.value}),placeholder:"Additional notes or comments",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,disabled:d})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:o,disabled:d,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:y,disabled:d||t.quantity<=0||!t.vendorId||!t.brandId||!t.reason||!t.date||!t.unitPrice||t.unitPrice<0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Processing...":"Send to Vendor"})]})]})})})},ut=({report:s,formData:t,vendors:p,brands:c,processing:d,onClose:o,onFormChange:x,onSubmit:y})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Receive from Vendor"}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",disabled:d,children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Item:"})," ",e.jsxs("span",{className:"text-gray-900",children:[s.itemName," (",s.skuCode||`SKU-${s.skuId}`,")"]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.vendorId,onChange:a=>x({vendorId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Vendor"}),p.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Brand ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.brandId,onChange:a=>x({brandId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Brand"}),c.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Originally Sent"}),e.jsx("input",{type:"text",value:g(s.sentToVendor||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Already Received"}),e.jsx("input",{type:"text",value:g(s.receivedBack||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Receive Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",max:s.sentToVendor||0,value:t.quantity,onChange:a=>x({quantity:parseInt(a.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Max: ",g(s.sentToVendor||0)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Short Item"}),e.jsx("input",{type:"number",min:"0",max:t.quantity||0,value:t.shortItem!==void 0?t.shortItem:"",onChange:a=>x({shortItem:parseInt(a.target.value)||0}),placeholder:"Enter short item quantity (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Enter the quantity of short items (if any). Max: ",g(t.quantity||0)]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:t.date,onChange:a=>x({date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Condition ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"condition",value:"replaced",checked:t.condition==="replaced",onChange:a=>x({condition:a.target.value}),className:"mr-2",disabled:d}),e.jsx("span",{className:"text-sm text-gray-700",children:"Replaced"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"condition",value:"repaired",checked:t.condition==="repaired",onChange:a=>x({condition:a.target.value}),className:"mr-2",disabled:d}),e.jsx("span",{className:"text-sm text-gray-700",children:"Repaired"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"condition",value:"as-is",checked:t.condition==="as-is",onChange:a=>x({condition:a.target.value}),className:"mr-2",disabled:d}),e.jsx("span",{className:"text-sm text-gray-700",children:"As-is (accepted)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice/Challan"}),e.jsx("input",{type:"text",value:t.invoiceChallan,onChange:a=>x({invoiceChallan:a.target.value}),placeholder:"Enter invoice or challan number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.remarks,onChange:a=>x({remarks:a.target.value}),placeholder:"Additional notes or comments",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,disabled:d})]}),e.jsxs("div",{className:"flex items-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("input",{type:"checkbox",id:"addToStock",checked:t.addToStock,onChange:a=>x({addToStock:a.target.checked}),className:"mr-2 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:d}),e.jsx("label",{htmlFor:"addToStock",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"✓ Add to Stock (increases inventory)"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:o,disabled:d,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:y,disabled:d||t.quantity<=0||!t.vendorId||!t.brandId||!t.date,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Processing...":"Receive & Add to Stock"})]})]})})}),xt=({report:s,formData:t,teams:p,processing:c,onClose:d,onFormChange:o,onSubmit:x})=>{const y=s.quantity-(s.sentToVendor||0)-(s.receivedBack||0)-(s.scrapped||0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Scrap Items"}),e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600",disabled:c,children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Item:"})," ",e.jsxs("span",{className:"text-gray-900",children:[s.itemName," (",s.skuCode||`SKU-${s.skuId}`,")"]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejected Quantity"}),e.jsx("input",{type:"text",value:g(s.quantity),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Already Scrapped"}),e.jsx("input",{type:"text",value:g(s.scrapped||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Scrap Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",max:y,value:t.quantity,onChange:a=>o({quantity:parseInt(a.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",disabled:c,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Max: ",g(y)]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:t.date,onChange:a=>o({date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",disabled:c,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"scrapReason",value:"beyond-repair",checked:t.scrapReason==="beyond-repair",onChange:a=>o({scrapReason:a.target.value,scrapReasonOther:""}),className:"mr-2",disabled:c}),e.jsx("span",{className:"text-sm text-gray-700",children:"Beyond repair"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"scrapReason",value:"not-worth-return",checked:t.scrapReason==="not-worth-return",onChange:a=>o({scrapReason:a.target.value,scrapReasonOther:""}),className:"mr-2",disabled:c}),e.jsx("span",{className:"text-sm text-gray-700",children:"Not worth return cost"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"scrapReason",value:"expired-obsolete",checked:t.scrapReason==="expired-obsolete",onChange:a=>o({scrapReason:a.target.value,scrapReasonOther:""}),className:"mr-2",disabled:c}),e.jsx("span",{className:"text-sm text-gray-700",children:"Expired/obsolete"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"scrapReason",value:"other",checked:t.scrapReason==="other",onChange:a=>o({scrapReason:a.target.value}),className:"mr-2",disabled:c}),e.jsx("span",{className:"text-sm text-gray-700 mr-2",children:"Other:"}),t.scrapReason==="other"&&e.jsx("input",{type:"text",value:t.scrapReasonOther,onChange:a=>o({scrapReasonOther:a.target.value}),placeholder:"Specify reason",className:"flex-1 px-3 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",disabled:c})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Approved By ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.approvedBy,onChange:a=>o({approvedBy:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",disabled:c,required:!0,children:[e.jsx("option",{value:"",children:"Select Team"}),p.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.remarks,onChange:a=>o({remarks:a.target.value}),placeholder:"Additional notes or comments",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",rows:3,disabled:c})]}),e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800 flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-600 font-bold",children:"⚠️"}),"This action cannot be undone"]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:d,disabled:c,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:x,disabled:c||t.quantity<=0||!t.date||!t.approvedBy||t.scrapReason==="other"&&!t.scrapReasonOther.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Processing...":"Confirm Scrap"})]})]})})})},mt=({report:s,onClose:t})=>{const p=s.netRejected!==void 0?s.netRejected:s.quantity-(s.sentToVendor||0)-(s.receivedBack||0)-(s.scrapped||0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Transaction History"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Report:"})," ",s.reportNumber]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Item:"})," ",s.itemName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Rejected Qty:"})," ",g(s.quantity)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Sent to Vendor:"})," ",g(s.sentToVendor||0)]})}),e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Received Back:"})," ",g(s.receivedBack||0)]})}),e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Scrapped:"})," ",g(s.scrapped||0)]})}),e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Net Rejected:"})," ",g(p)]})})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"})})]})})})},pt=({report:s,formData:t,vendors:p,brands:c,teams:d,processing:o,onClose:x,onFormChange:y,onSubmit:a})=>{const f=s.shortQuantity-(s.receivedBack||0);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Receive Back"}),e.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600",disabled:o,children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Item:"})," ",e.jsxs("span",{className:"text-gray-900",children:[s.itemName," (",s.skuCode||`SKU-${s.skuId}`,")"]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.vendorId,onChange:m=>y({vendorId:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0,children:[e.jsx("option",{value:"",children:"Select Vendor"}),p.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Brand ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.brandId,onChange:m=>y({brandId:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0,children:[e.jsx("option",{value:"",children:"Select Brand"}),c.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shorted Value"}),e.jsx("input",{type:"text",value:g(s.shortQuantity),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700",readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Receive Shorted Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",max:f,value:t.quantity,onChange:m=>y({quantity:parseInt(m.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Max: ",g(f)]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:t.date,onChange:m=>y({date:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Invoice Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.invoiceChallan,onChange:m=>y({invoiceChallan:m.target.value}),placeholder:"Enter invoice number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Received By ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.receivedBy||"",onChange:m=>y({receivedBy:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0,children:[e.jsx("option",{value:"",children:"Select Team Member"}),d.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:x,disabled:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:a,disabled:o||t.quantity<=0||!t.vendorId||!t.brandId||!t.date||!t.invoiceChallan||!t.receivedBy,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Processing...":"Receive Back"})]})]})})})},Tt=()=>{const[s,t]=h.useState("rejected"),[p,c]=h.useState(!1),[d,o]=h.useState([]),[x,y]=h.useState([]),[a,l]=h.useState([]),[f,m]=h.useState([]),[B,Y]=h.useState(!1),[S,le]=h.useState(""),[$,ie]=h.useState(""),[M,ce]=h.useState(""),[oe,ke]=h.useState(!1),[F,A]=h.useState(null),ue=h.useRef({}),[U,_]=h.useState(null),xe=h.useRef({}),[w,G]=h.useState(null),[I,W]=h.useState(null),[R,Z]=h.useState(null),[me,pe]=h.useState(null),[C,D]=h.useState(null),[n,H]=h.useState({quantity:0,remarks:"",vendorId:"",brandId:"",date:new Date().toISOString().split("T")[0],docketTracking:"",transporter:"",reason:"",condition:"replaced",invoiceChallan:"",addToStock:!0,scrapReason:"beyond-repair",scrapReasonOther:"",approvedBy:"",unitPrice:void 0,shortItem:void 0}),[J,V]=h.useState(!1),[j,ee]=h.useState({quantity:0,remarks:"",vendorId:"",brandId:"",date:new Date().toISOString().split("T")[0],docketTracking:"",transporter:"",reason:"",condition:"replaced",invoiceChallan:"",addToStock:!0,receivedBy:""}),[te,Ie]=h.useState([]),[se,Se]=h.useState([]),[he,Re]=h.useState([]);h.useEffect(()=>{E(),K(),Ce()},[]);const Ce=async()=>{try{const[r,i,u]=await Promise.all([ne.getYourVendors(),ne.getYourBrands(),ne.getTeams()]);Ie(r.data||[]),Se(i.data||[]),Re(u.data||[])}catch(r){console.error("Error loading vendors, brands, and teams:",r)}};h.useEffect(()=>{qe(),Te()},[d,a,S,$,M]),h.useEffect(()=>{const r=i=>{if(F!==null){const u=ue.current[F];u&&!u.contains(i.target)&&A(null)}if(U!==null){const u=xe.current[U];u&&!u.contains(i.target)&&_(null)}};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[F,U]);const E=async()=>{try{c(!0);const r={};$&&(r.dateFrom=$),M&&(r.dateTo=M),S&&(r.search=S);const i=await T.getRejectedItemReports(r);if(i.success){const u=i.data||[];o(u)}}catch(r){console.error("Error loading rejected item reports:",r)}finally{c(!1)}},K=async()=>{try{Y(!0);const r={};$&&(r.dateFrom=$),M&&(r.dateTo=M),S&&(r.search=S);const i=await T.getShortItemReports(r);if(i.success){const u=i.data||[];l(u)}}catch(r){console.error("Error loading short item reports:",r)}finally{Y(!1)}},qe=()=>{let r=[...d];if(S){const i=S.toLowerCase();r=r.filter(u=>{var v,b,N,k;return((v=u.reportNumber)==null?void 0:v.toLowerCase().includes(i))||((b=u.skuCode)==null?void 0:b.toLowerCase().includes(i))||((N=u.itemName)==null?void 0:N.toLowerCase().includes(i))||((k=u.originalInvoiceNumber)==null?void 0:k.toLowerCase().includes(i))})}y(r)},Te=()=>{let r=[...a];if(S){const i=S.toLowerCase();r=r.filter(u=>{var v,b,N;return((v=u.invoiceNumber)==null?void 0:v.toLowerCase().includes(i))||((b=u.skuCode)==null?void 0:b.toLowerCase().includes(i))||((N=u.itemName)==null?void 0:N.toLowerCase().includes(i))})}m(r)},Be=()=>{console.log("Export functionality to be implemented")},Ve=()=>{le(""),ie(""),ce("")},Pe=r=>{_(U===r?null:r)},be=()=>({quantity:0,remarks:"",vendorId:"",brandId:"",date:new Date().toISOString().split("T")[0],docketTracking:"",transporter:"",reason:"",condition:"replaced",invoiceChallan:"",addToStock:!0,receivedBy:""}),ge=()=>{ee(be())},Qe=r=>{_(null);const i=r.shortQuantity-(r.receivedBack||0);ee({...be(),quantity:Math.max(0,i),vendorId:r.vendorId||"",brandId:r.brandId||""}),D(r)},$e=async()=>{var i,u,v,b,N;if(!C)return;if(!j.vendorId){alert("Please select a vendor");return}if(!j.brandId){alert("Please select a brand");return}if(!j.date){alert("Please select a date");return}if(!j.invoiceChallan){alert("Please enter invoice number");return}if(!j.receivedBy){alert("Please select received by");return}if(j.quantity<=0){alert("Quantity must be greater than 0");return}const r=C.shortQuantity-(C.receivedBack||0);if(j.quantity>r){alert("Quantity exceeds available short quantity");return}try{V(!0);let k=.01;try{const q=await de.getById(C.skuId);q!=null&&q.success&&((i=q.data)!=null&&i.unitPrice)&&(k=q.data.unitPrice>0?q.data.unitPrice:.01)}catch(q){console.warn("Could not fetch SKU unit price, using 0.01:",q)}const L={invoiceDate:j.date,invoiceNumber:j.invoiceChallan,receivingDate:j.date,vendorId:parseInt(j.vendorId),brandId:parseInt(j.brandId),receivedBy:parseInt(j.receivedBy),documentType:"bill",status:"completed",remarks:j.remarks||`Short items received back. Original invoice: ${C.invoiceNumber}`,items:[{skuId:C.skuId,received:j.quantity,short:0,totalQuantity:j.quantity,unitPrice:k,totalValue:j.quantity*k}]};await T.addIncoming(L);const P=C.shortQuantity-j.quantity;await T.updateShortItem(C.incomingInventoryId,{itemId:C.incomingInventoryItemId,short:Math.max(0,P)}),await K(),D(null),ge(),alert("Short items received back successfully and added to stock")}catch(k){console.error("Error receiving back short items:",k),alert(((v=(u=k.response)==null?void 0:u.data)==null?void 0:v.error)||((N=(b=k.response)==null?void 0:b.data)==null?void 0:N.message)||"Failed to receive back short items")}finally{V(!1)}},Me=r=>{_(null),console.log("View history for short item:",r),alert("History view functionality to be implemented")},Ae=r=>{A(F===r?null:r)},X=()=>({quantity:0,remarks:"",vendorId:"",brandId:"",date:new Date().toISOString().split("T")[0],docketTracking:"",transporter:"",reason:"",condition:"replaced",invoiceChallan:"",addToStock:!0,scrapReason:"beyond-repair",scrapReasonOther:"",approvedBy:"",unitPrice:void 0,shortItem:void 0}),O=()=>{H(X())},Ee=async r=>{var v;A(null);const i=r.quantity-(r.sentToVendor||0)-(r.receivedBack||0)-(r.scrapped||0);let u;try{const b=await de.getById(r.skuId);b!=null&&b.success&&((v=b.data)!=null&&v.unitPrice)&&(u=b.data.unitPrice)}catch(b){console.warn("Could not fetch SKU unit price for default:",b)}H({...X(),quantity:Math.max(0,i),vendorId:r.vendorId||"",brandId:r.brandId||"",unitPrice:u}),G(r)},Oe=r=>{A(null);const i=r.sentToVendor||0;H({...X(),quantity:Math.max(0,i),vendorId:r.vendorId||"",brandId:r.brandId||""}),W(r)},Le=r=>{A(null);const i=r.quantity-(r.sentToVendor||0)-(r.receivedBack||0)-(r.scrapped||0);H({...X(),quantity:Math.max(0,i)}),Z(r)},Fe=r=>{A(null),pe(r)},ae=r=>{H(i=>({...i,...r}))},Ue=async()=>{var r,i,u,v;if(w){if(!n.vendorId){alert("Please select a vendor");return}if(!n.brandId){alert("Please select a brand");return}if(!n.reason){alert("Please enter a reason");return}if(!n.date){alert("Please select a date");return}if(n.quantity<=0){alert("Quantity must be greater than 0");return}if(n.quantity>w.quantity-(w.sentToVendor||0)-(w.receivedBack||0)-(w.scrapped||0)){alert("Quantity exceeds available rejected quantity");return}if(n.unitPrice===void 0||n.unitPrice===null||n.unitPrice<0){alert("Please enter a valid unit price (must be 0 or greater)");return}try{V(!0);const b=w.reportNumber||`REJ-${w.originalInvoiceNumber}-${Date.now()}`,N=n.unitPrice>0?n.unitPrice:.01,k={documentType:"delivery_challan",documentSubType:"replacement",deliveryChallanSubType:"to_vendor",invoiceChallanDate:n.date,invoiceChallanNumber:b,docketNumber:n.docketTracking||"",transportorName:n.transporter||"",destinationType:"vendor",destinationId:parseInt(n.vendorId),remarks:n.remarks||`Rejected items sent to vendor. Reason: ${n.reason}`,status:"completed",items:[{skuId:w.skuId,outgoingQuantity:n.quantity,unitPrice:N,totalValue:N*n.quantity}]};await T.addOutgoing(k);const L=(w.sentToVendor||0)+n.quantity,P=Math.max(0,w.quantity-L-(w.receivedBack||0)-(w.scrapped||0));await T.updateRejectedItemReport(w.id,{sentToVendor:L,netRejected:P}),await E(),G(null),O(),alert(`Items sent to vendor successfully. Report Number: ${b}`)}catch(b){console.error("Error sending to vendor:",b),alert(((i=(r=b.response)==null?void 0:r.data)==null?void 0:i.error)||((v=(u=b.response)==null?void 0:u.data)==null?void 0:v.message)||"Failed to send items to vendor")}finally{V(!1)}}},He=async()=>{var r,i,u,v,b;if(I){if(!n.vendorId){alert("Please select a vendor");return}if(!n.brandId){alert("Please select a brand");return}if(!n.date){alert("Please select a date");return}if(n.quantity<=0){alert("Quantity must be greater than 0");return}if(n.quantity>(I.sentToVendor||0)){alert("Quantity exceeds sent to vendor quantity");return}if(n.shortItem!==void 0&&n.shortItem>n.quantity){alert("Short item quantity cannot exceed receive quantity");return}try{V(!0);const N=(I.receivedBack||0)+n.quantity,k=Math.max(0,(I.sentToVendor||0)-n.quantity),L=Math.max(0,I.quantity-k-N-(I.scrapped||0));if(await T.updateRejectedItemReport(I.id,{sentToVendor:k,receivedBack:N,netRejected:L}),n.addToStock||n.shortItem!==void 0&&n.shortItem>0){const q=n.addToStock?n.quantity:0,ye=n.shortItem||0,je=q+ye,_e=n.invoiceChallan||`RECV-${I.reportNumber}-${Date.now()}`;let re=.01;try{const Q=await de.getById(I.skuId);Q!=null&&Q.success&&((r=Q.data)!=null&&r.unitPrice)&&(re=Q.data.unitPrice>0?Q.data.unitPrice:.01)}catch(Q){console.warn("Could not fetch SKU unit price, using 0.01:",Q)}const Je={invoiceDate:n.date,invoiceNumber:_e,receivingDate:n.date,vendorId:parseInt(n.vendorId),brandId:parseInt(n.brandId),documentType:"bill",status:"completed",remarks:n.remarks||`Items received from vendor. Condition: ${n.condition}. ${I.reportNumber?`Report: ${I.reportNumber}`:""}`,items:[{skuId:I.skuId,received:q,short:ye,totalQuantity:je,unitPrice:re,totalValue:je*re}]};await T.addIncoming(Je)}await E(),await K(),W(null),O();const P=[];n.addToStock&&P.push("added to stock"),n.shortItem&&n.shortItem>0&&P.push("short item recorded"),alert(`Items received from vendor successfully${P.length>0?` and ${P.join(", ")}`:""}`)}catch(N){console.error("Error receiving from vendor:",N),alert(((u=(i=N.response)==null?void 0:i.data)==null?void 0:u.error)||((b=(v=N.response)==null?void 0:v.data)==null?void 0:b.message)||"Failed to receive items from vendor")}finally{V(!1)}}},Ke=async()=>{var r,i;if(R){if(!n.date){alert("Please select a date");return}if(n.quantity<=0){alert("Quantity must be greater than 0");return}if(n.quantity>R.quantity-(R.sentToVendor||0)-(R.receivedBack||0)-(R.scrapped||0)){alert("Quantity exceeds available rejected quantity");return}if(n.scrapReason==="other"&&!n.scrapReasonOther.trim()){alert("Please specify the reason for scrapping");return}if(!n.approvedBy){alert("Please select who approved this scrap action");return}try{V(!0);const u=(R.scrapped||0)+n.quantity,v=Math.max(0,R.quantity-(R.sentToVendor||0)-(R.receivedBack||0)-u);await T.updateRejectedItemReport(R.id,{scrapped:u,netRejected:v}),await E(),Z(null),O(),alert("Items marked as scrapped successfully")}catch(u){console.error("Error scrapping items:",u),alert(((i=(r=u.response)==null?void 0:r.data)==null?void 0:i.error)||"Failed to scrap items")}finally{V(!1)}}},ze=()=>d.length,Ye=()=>a.length;return e.jsxs("div",{className:"p-4 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>t("rejected"),className:`flex items-center gap-3 px-6 py-4 rounded-lg border-2 transition-all ${s==="rejected"?"bg-white border-orange-500 shadow-md":"bg-gray-100 border-gray-300 hover:bg-gray-200"}`,children:[e.jsx("div",{className:`p-2 rounded-full ${s==="rejected"?"bg-orange-100":"bg-gray-200"}`,children:e.jsx(et,{className:`w-5 h-5 ${s==="rejected"?"text-orange-600":"text-gray-600"}`})}),e.jsx("span",{className:`font-medium ${s==="rejected"?"text-orange-600":"text-gray-600"}`,children:"Rejected Items"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-sm font-medium ${s==="rejected"?"bg-orange-100 text-orange-600":"bg-gray-200 text-gray-600"}`,children:ze()})]}),e.jsxs("button",{onClick:()=>t("short"),className:`flex items-center gap-3 px-6 py-4 rounded-lg border-2 transition-all ${s==="short"?"bg-white border-orange-500 shadow-md":"bg-gray-100 border-gray-300 hover:bg-gray-200"}`,children:[e.jsx("div",{className:`p-2 rounded-full ${s==="short"?"bg-orange-100":"bg-gray-200"}`,children:e.jsx(Ge,{className:`w-5 h-5 ${s==="short"?"text-orange-600":"text-gray-600"}`})}),e.jsx("span",{className:`font-medium ${s==="short"?"text-orange-600":"text-gray-600"}`,children:"Short Shipments"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-sm font-medium ${s==="short"?"bg-orange-100 text-orange-600":"bg-gray-200 text-gray-600"}`,children:Ye()})]})]}),e.jsx(at,{search:S,dateFrom:$,dateTo:M,showFilters:oe,onSearchChange:le,onDateFromChange:ie,onDateToChange:ce,onToggleFilters:()=>ke(!oe),onClearFilters:Ve,onApplyFilters:()=>{E(),K()}}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mb-4",children:[e.jsxs("button",{onClick:()=>{s==="rejected"?E():K()},disabled:s==="rejected"?p:B,className:"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:[e.jsx(st,{className:`w-4 h-4 inline mr-2 ${(s==="rejected"?p:B)?"animate-spin":""}`}),"Refresh"]}),e.jsxs("button",{onClick:Be,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:[e.jsx(tt,{className:"w-4 h-4 inline mr-2"}),"Export"]})]}),s==="rejected"?e.jsx(lt,{reports:x,loading:p,openDropdownId:F,dropdownRefs:ue,onToggleDropdown:Ae,onSendToVendor:Ee,onReceiveFromVendor:Oe,onScrap:Le,onViewHistory:Fe}):e.jsx(ct,{reports:f,loading:B,openDropdownId:U,dropdownRefs:xe,onToggleDropdown:Pe,onReceiveBack:Qe,onViewHistory:Me}),w&&e.jsx(ot,{report:w,formData:n,vendors:te,brands:se,processing:J,onClose:()=>{G(null),O()},onFormChange:ae,onSubmit:Ue}),I&&e.jsx(ut,{report:I,formData:n,vendors:te,brands:se,processing:J,onClose:()=>{W(null),O()},onFormChange:ae,onSubmit:He}),R&&e.jsx(xt,{report:R,formData:n,teams:he,processing:J,onClose:()=>{Z(null),O()},onFormChange:ae,onSubmit:Ke}),me&&e.jsx(mt,{report:me,onClose:()=>pe(null)}),C&&e.jsx(pt,{report:C,formData:j,vendors:te,brands:se,teams:he,processing:J,onClose:()=>{D(null),ge()},onFormChange:r=>ee(i=>({...i,...r})),onSubmit:$e})]})};export{Tt as default};
