import{c as W,u as pe,r as s,j as e,R as ue}from"./index-v4UyLoar.js";import{s as Y}from"./skuService-CD47JNeC.js";import{l as C}from"./libraryService-BqxRzzIS.js";import{f as j}from"./formatters-ptPrPoGe.js";import{o as fe}from"./categoriesEvents-i2FsXa12.js";import{S as ye}from"./search-C_UOvm8j.js";import{T as je}from"./trash-2-F_yzDzD4.js";import{C as be}from"./chevron-right-DasLtTte.js";import{A as $,a as V}from"./arrow-up-BUb5EjXf.js";import"./api-VNhYhLPD.js";import"./cachedApi-CKq13PPM.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=W("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=W("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]),Pe=()=>{pe();const[q,U]=s.useState(!1),[K,P]=s.useState([]),[k,G]=s.useState(0),[m,I]=s.useState(1),[b]=s.useState(20),[y,J]=s.useState([]),[R,Q]=s.useState(new Set),[S,X]=s.useState(""),[i,Z]=s.useState(""),[d,D]=s.useState(""),[N,L]=s.useState(""),[w,ee]=s.useState(""),[g,te]=s.useState("all"),[h,se]=s.useState(""),[u,M]=s.useState("asc"),[ae,re]=s.useState([]),[le,T]=s.useState([]),[oe,A]=s.useState([]),[ne,ce]=s.useState([]);s.useEffect(()=>{O()},[]),s.useEffect(()=>fe(()=>{O(),i&&_(parseInt(i)),d&&F(parseInt(d))}),[i,d]),s.useEffect(()=>{z()},[m,S,i,d,N,w,g,h,u]),s.useEffect(()=>{i?_(parseInt(i)):(T([]),D(""),L(""),A([]))},[i]),s.useEffect(()=>{d?F(parseInt(d)):(A([]),L(""))},[d]);const O=async()=>{try{const[t,a]=await Promise.all([C.getYourProductCategories(),C.getBrands()]);re(t.data||[]),ce(a.data||[])}catch(t){console.error("Error loading initial data:",t)}},_=async t=>{try{const a=await C.getYourItemCategories(t);T(a.data||[])}catch(a){console.error("Error loading item categories:",a)}},F=async t=>{try{const a=await C.getYourSubCategories(t);A(a.data||[])}catch(a){console.error("Error loading sub categories:",a)}},z=async()=>{try{U(!0);const t={page:m,limit:b};if(S&&(t.search=S),i&&(t.productCategory=i),d&&(t.itemCategory=d),N&&(t.subCategory=N),w&&(t.brand=w),g!=="all"){const o={out_of_stock:"out",low_stock:"low",in_stock:"in"};t.stockStatus=o[g]||g,console.log("[SKU Filter] Frontend status:",g,"â†’ Backend status:",t.stockStatus)}h&&(t.sortBy=h,t.sortOrder=u);const a=await Y.getAll(t);let c=a.data||[];if(g!=="all"&&c.length>0){const o=c.reduce((n,l)=>{const r=l.currentStock??0,f=l.minStockLevel??l.minStock??0;let x="In Stock";return r===0?x="Out of Stock":r<=f&&(x="Low Stock"),n[x]=(n[x]||0)+1,n},{});console.log("[SKU Filter] Results:",o,"Total items:",c.length)}h&&c.length>0&&(c=[...c].sort((o,n)=>{var f,x,p,H;let l,r;switch(h){case"itemName":l=((f=o.itemName)==null?void 0:f.toLowerCase())||"",r=((x=n.itemName)==null?void 0:x.toLowerCase())||"";break;case"brand":l=((p=o.brand)==null?void 0:p.toLowerCase())||"",r=((H=n.brand)==null?void 0:H.toLowerCase())||"";break;case"totalStocks":l=o.totalStocks??o.currentStock??0,r=n.totalStocks??n.currentStock??0;break;case"bookStocks":l=o.bookStocks??0,r=n.bookStocks??0;break;case"shortStocks":l=o.shortStocks??0,r=n.shortStocks??0;break;case"usefulStocks":const xe=o.totalStocks??o.currentStock??0,me=o.bookStocks??0,ge=n.totalStocks??n.currentStock??0,he=n.bookStocks??0;l=o.usefulStocks??xe-me,r=n.usefulStocks??ge-he;break;default:return 0}return typeof l=="string"&&typeof r=="string"?u==="asc"?l.localeCompare(r):r.localeCompare(l):u==="asc"?l-r:r-l})),P(c),G(a.total||0)}catch(t){console.error("Error loading SKUs:",t),P([])}finally{U(!1)}},ie=async()=>{var t,a;if(y.length!==0&&window.confirm(`Are you sure you want to delete ${y.length} SKU(s)?`))try{await Promise.all(y.map(c=>Y.delete(c))),J([]),z()}catch(c){alert(((a=(t=c.response)==null?void 0:t.data)==null?void 0:a.error)||"Failed to delete SKUs")}},de=(t,a)=>t===0?{label:"Out of Stock",color:"text-red-700",bgColor:"bg-red-100"}:t<=a?{label:"Low Stock",color:"text-yellow-700",bgColor:"bg-yellow-100"}:{label:"In Stock",color:"text-green-700",bgColor:"bg-green-100"},E=t=>{h===t?M(u==="asc"?"desc":"asc"):(se(t),M("asc")),I(1)},B=({field:t})=>h!==t?e.jsxs("span",{className:"inline-flex flex-col ml-1 text-gray-400",children:[e.jsx($,{className:"w-3 h-3 -mb-0.5"}),e.jsx(V,{className:"w-3 h-3"})]}):u==="asc"?e.jsx($,{className:"w-4 h-4 ml-1 text-blue-600"}):e.jsx(V,{className:"w-4 h-4 ml-1 text-blue-600"}),v=Math.ceil(k/b);return e.jsxs("div",{className:"p-4 space-y-4",style:{transform:"scale(0.8)",transformOrigin:"top left",width:"125%",height:"125%"},children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"SKU Management"})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search SKU ID, Item Name, Model Number, HSN Code...",value:S,onChange:t=>X(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("select",{value:i,onChange:t=>Z(t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Product Categories"}),ae.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("select",{value:d,onChange:t=>D(t.target.value),disabled:!i,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"All Item Categories"}),le.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("select",{value:N,onChange:t=>L(t.target.value),disabled:!d,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"All Sub Categories"}),oe.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("select",{value:w,onChange:t=>ee(t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Brands"}),ne.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}),e.jsx("div",{className:"w-full lg:w-40",children:e.jsxs("select",{value:g,onChange:t=>te(t.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Stock Status"}),e.jsx("option",{value:"out_of_stock",children:"Out of Stock"}),e.jsx("option",{value:"low_stock",children:"Low Stock"}),e.jsx("option",{value:"in_stock",children:"In Stock"})]})})]})}),y.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[y.length," item(s) selected"]}),e.jsxs("button",{onClick:ie,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),"Delete Selected"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"SKU ID"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>E("itemName"),children:e.jsxs("div",{className:"flex items-center justify-center",children:["Item Name",e.jsx(B,{field:"itemName"})]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Model Number"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"HSN Code"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>E("brand"),children:e.jsxs("div",{className:"flex items-center justify-center",children:["Brand",e.jsx(B,{field:"brand"})]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none",onClick:()=>E("usefulStocks"),children:e.jsxs("div",{className:"flex items-center justify-center",children:["Available Stocks",e.jsx(B,{field:"usefulStocks"})]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})})})}):K.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No SKUs found"})}):K.map(t=>{const a=t.totalStocks??t.currentStock??0,c=t.bookStocks??0,o=t.usefulStocks??a-c,n=t.currentStock??0,l=t.minStockLevel??t.minStock??0,r=de(n,l),f=R.has(t.id),x=()=>{const p=new Set(R);p.has(t.id)?p.delete(t.id):p.add(t.id),Q(p)};return e.jsxs(ue.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 text-center cursor-pointer hover:text-blue-600 transition-colors",onClick:x,title:"Click to view details",children:t.skuId}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-center",children:t.itemName}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-center",children:t.model||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-center",children:t.hsnSacCode||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 text-center",children:t.brand}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-green-600 text-center",children:j(o)}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${r.bgColor} ${r.color}`,children:r.label})})]}),f&&e.jsx("tr",{className:"bg-gray-50",children:e.jsx("td",{colSpan:7,className:"px-4 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.ratingSize&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Rating/Size"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.ratingSize})]}),t.model&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Model"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.model})]}),t.series&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Series"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.series})]})]})]}),(t.material||t.insulation||t.inputSupply||t.color||t.cri||t.cct||t.beamAngle||t.ledType||t.shape||t.weight!==void 0&&t.weight!==null&&t.weight!==0||t.length!==void 0&&t.length!==null&&t.length!==0||t.width!==void 0&&t.width!==null&&t.width!==0||t.height!==void 0&&t.height!==null&&t.height!==0)&&e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"flex items-center justify-between cursor-pointer text-sm font-semibold text-gray-900 hover:text-blue-600 transition-colors",children:[e.jsx("span",{children:"Optional Specifications"}),e.jsx(Ne,{className:"w-4 h-4 text-gray-500 group-open:rotate-180 transition-transform"})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 text-sm",children:[t.material&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Material:"}),e.jsx("p",{className:"text-gray-600",children:t.material})]}),t.insulation&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Insulation:"}),e.jsx("p",{className:"text-gray-600",children:t.insulation})]}),t.inputSupply&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Input Supply:"}),e.jsx("p",{className:"text-gray-600",children:t.inputSupply})]}),t.color&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Color:"}),e.jsx("p",{className:"text-gray-600",children:t.color})]}),t.cri&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"CRI:"}),e.jsx("p",{className:"text-gray-600",children:t.cri})]}),t.cct&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"CCT:"}),e.jsx("p",{className:"text-gray-600",children:t.cct})]}),t.beamAngle&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Beam Angle:"}),e.jsx("p",{className:"text-gray-600",children:t.beamAngle})]}),t.ledType&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"LED Type:"}),e.jsx("p",{className:"text-gray-600",children:t.ledType})]}),t.shape&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Shape:"}),e.jsx("p",{className:"text-gray-600",children:t.shape})]}),t.weight!==void 0&&t.weight!==null&&t.weight!==0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Weight (Kg):"}),e.jsx("p",{className:"text-gray-600",children:j(t.weight)})]}),t.length!==void 0&&t.length!==null&&t.length!==0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Length (mm):"}),e.jsx("p",{className:"text-gray-600",children:j(t.length)})]}),t.width!==void 0&&t.width!==null&&t.width!==0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Width (mm):"}),e.jsx("p",{className:"text-gray-600",children:j(t.width)})]}),t.height!==void 0&&t.height!==null&&t.height!==0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Height (mm):"}),e.jsx("p",{className:"text-gray-600",children:j(t.height)})]})]})})]})]})})})]},t.id)})})]})}),v>1&&e.jsxs("div",{className:"bg-gray-50 px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(m-1)*b+1," to ",Math.min(m*b,k)," of ",k," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>I(t=>Math.max(1,t-1)),disabled:m===1,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Se,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",m," of ",v]}),e.jsx("button",{onClick:()=>I(t=>Math.min(v,t+1)),disabled:m===v,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(be,{className:"w-5 h-5"})})]})]})]})]})};export{Pe as default};
