import{u as ce,r as N,j as e}from"./index-BNvq7L73.js";import{b as de,v as R}from"./validators-CanHBN9q.js";import{a as k}from"./api-BJ7xcL-N.js";import{l as ne}from"./libraryService-1-VsGbkQ.js";import{A as me}from"./arrow-left-BgDROCgl.js";import{C as ue}from"./check-circle-2-B5DaI6Em.js";import{U as G}from"./user-plus-qmox-up4.js";import{P as ge}from"./plus-i3erHhTd.js";import{X as xe}from"./x-DoRfBOx5.js";import"./cachedApi-DyAQX7TM.js";const Ie=()=>{const U=ce(),[q,L]=N.useState(!1),[H,E]=N.useState(!1),[Q,$]=N.useState(""),[r,i]=N.useState({email:"",firstName:"",lastName:"",employeeId:"",role:"",department:"",moduleAccess:{dashboard:{view:!0,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:[]}),[O,Z]=N.useState([]),[D,P]=N.useState([]),[_,F]=N.useState([]),[V,M]=N.useState([]),[a,p]=N.useState({}),[T,W]=N.useState([]),[v,A]=N.useState(null),[S,z]=N.useState(!1);N.useEffect(()=>{k.get("/categories/product").then(t=>{Z(t.data.data||[])}).catch(t=>{console.error("Error loading categories:",t)}),(async()=>{try{z(!0);const t=await ne.getTeams();W(t.data||[])}catch(t){console.error("Error loading teams:",t),W([])}finally{z(!1)}})()},[]);const ee=async()=>{var g,m,h,u,f,c,x,l,b,y,n,j,o,w,I;const s={};if(de(r.email)||(s.email="Valid email is required"),R(r.firstName)||(s.firstName="First Name is required"),R(r.lastName)||(s.lastName="Last Name is required"),R(r.role)||(s.role="Role is required"),Object.values(r.moduleAccess).some(d=>d.view||d.create||d.edit||d.delete)||(s.moduleAccess="At least one permission must be selected in Module Access"),r.categoryAccess.length>0&&r.categoryAccess.forEach((d,C)=>{var J,K,X,Y;((J=d.permissions)==null?void 0:J.view)||((K=d.permissions)==null?void 0:K.create)||((X=d.permissions)==null?void 0:X.edit)||((Y=d.permissions)==null?void 0:Y.delete)||(s[`categoryAccess_${C}`]=`Category Access ${C+1}: At least one permission must be selected`)}),Object.keys(s).length>0){p(s);return}try{L(!0),await k.post("/users/invite",r),$(r.email),E(!0),A(null),i({email:"",firstName:"",lastName:"",employeeId:"",role:"",department:"",moduleAccess:{dashboard:{view:!0,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:[]}),p({}),setTimeout(()=>{E(!1),$("")},5e3)}catch(d){if(console.error("Error inviting user:",d),((g=d.response)==null?void 0:g.status)===409){const C=((h=(m=d.response)==null?void 0:m.data)==null?void 0:h.error)||((f=(u=d.response)==null?void 0:u.data)==null?void 0:f.message)||"User with this email already exists";alert(`Invitation failed: ${C}

Please use a different email address or check if this user has already been invited.`)}else if(((c=d.response)==null?void 0:c.status)===400){const C=((l=(x=d.response)==null?void 0:x.data)==null?void 0:l.error)||((y=(b=d.response)==null?void 0:b.data)==null?void 0:y.message)||"Invalid data provided";alert(`Invitation failed: ${C}

Please check all required fields and try again.`)}else if(((n=d.response)==null?void 0:n.status)===500)alert("Server error: Failed to send invitation. Please try again later or contact support.");else{const C=((o=(j=d.response)==null?void 0:j.data)==null?void 0:o.error)||((I=(w=d.response)==null?void 0:w.data)==null?void 0:I.message)||d.message||"Failed to send invitation";alert(`Invitation failed: ${C}`)}}finally{L(!1)}},te=()=>{i({...r,categoryAccess:[...r.categoryAccess,{productCategoryIds:[],itemCategoryIds:[],subCategoryIds:[],itemIds:[],permissions:{view:!0,create:!0,edit:!0,delete:!0}}]})},se=async s=>{if(!s||s.length===0){P([]);return}try{const t=[];for(const m of s){const h=await k.get("/categories/item",{params:{productCategoryId:m}});t.push(...h.data.data||[])}const g=t.filter((m,h,u)=>h===u.findIndex(f=>f.id===m.id));P(g)}catch(t){console.error("Error loading item categories:",t),P([])}},re=async s=>{if(!s||s.length===0){F([]);return}try{const t=[];for(const m of s){const h=await k.get("/categories/sub",{params:{itemCategoryId:m}});t.push(...h.data.data||[])}const g=t.filter((m,h,u)=>h===u.findIndex(f=>f.id===m.id));F(g)}catch(t){console.error("Error loading sub categories:",t),F([])}},ae=async(s,t,g)=>{if(!(s!=null&&s.length)||!(t!=null&&t.length)||!(g!=null&&g.length)){M([]);return}try{const m=[];for(const u of s)for(const f of t)for(const c of g){const x=await k.get("/skus",{params:{productCategory:u,itemCategory:f,subCategory:c,limit:1e3}});m.push(...x.data.data||[])}const h=m.filter((u,f,c)=>f===c.findIndex(x=>x.id===u.id));M(h)}catch(m){console.error("Error loading items:",m),M([])}},le=s=>{i({...r,categoryAccess:r.categoryAccess.filter((t,g)=>g!==s)})},oe=s=>{if(!s||s===""){A(null),i({...r,email:"",firstName:"",lastName:"",employeeId:"",department:""});return}const t=T.find(f=>f.id===parseInt(s));if(!t)return;A(parseInt(s));const g=(t.name||"").trim().split(" "),m=g[0]||"",h=g.slice(1).join(" ")||"";i({...r,email:t.emailId||"",firstName:m,lastName:h,department:t.department||""});const u={...a};u.email&&delete u.email,u.firstName&&delete u.firstName,u.lastName&&delete u.lastName,p(u)},ie=()=>{A(null),i({email:"",firstName:"",lastName:"",employeeId:"",role:"",department:"",moduleAccess:{dashboard:{view:!0,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:[]}),p({}),E(!1),$("")};return e.jsxs("div",{className:"p-8 space-y-10 w-full max-w-5xl mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>U("/app/access-control"),className:"text-slate-600 hover:text-slate-900 transition-colors",title:"Back to Access Control",children:e.jsx(me,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-4xl font-black text-slate-900 tracking-tight",children:"Invite User"})]}),e.jsx("p",{className:"text-lg text-slate-500 font-medium",children:"Send an invitation to a new user to join the system."})]})}),H&&e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-[2rem] p-6 flex items-center gap-3",children:[e.jsx(ue,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-800 font-medium",children:"Invitation sent successfully!"}),e.jsxs("p",{className:"text-green-700 text-sm",children:["An invitation email has been sent to ",Q||"the user","."]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"Select Team Member"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Team Member ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:v||"",onChange:s=>oe(s.target.value),disabled:S,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${S?"bg-gray-100 cursor-not-allowed":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select a team member from library"}),T.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.emailId," (",s.department,")"]},s.id))]}),S&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Loading team members..."}),!S&&T.length===0&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No team members found in library"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:r.email,readOnly:!!v,onChange:s=>{v||(i({...r,email:s.target.value}),a.email&&p({...a,email:""}))},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.email?"border-red-500":"border-gray-300"} ${v?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"user@example.com"}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.role,onChange:s=>{const t=s.target.value;if(t==="admin")i({...r,role:t,moduleAccess:{dashboard:{view:!0,create:!0,edit:!0,delete:!0},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!0,edit:!0,delete:!0},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:r.categoryAccess.length>0?r.categoryAccess:[]});else if(t==="sales")i({...r,role:t,moduleAccess:{dashboard:{view:!1,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!1,edit:!1,delete:!1},inventory:{view:!1,create:!1,edit:!1,delete:!1},reports:{view:!1,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!1,create:!1,edit:!1,delete:!1},itemCategory:{view:!1,create:!1,edit:!1,delete:!1},subCategory:{view:!1,create:!1,edit:!1,delete:!1}},categoryAccess:[]});else if(t&&t!=="")if(window.confirm(`Are you sure you want to give access to ${t} role? You can configure specific permissions manually.`))i({...r,role:t});else{s.target.value=r.role;return}else i({...r,role:t});a.role&&p({...a,role:""})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.role?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"sales",children:"User"}),e.jsx("option",{value:"warehouse",disabled:!0,className:"opacity-50",children:"Warehouse"}),e.jsx("option",{value:"accountant",disabled:!0,className:"opacity-50",children:"Accountant"})]}),a.role&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.role})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.firstName,readOnly:!!v,onChange:s=>{v||(i({...r,firstName:s.target.value}),a.firstName&&p({...a,firstName:""}))},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.firstName?"border-red-500":"border-gray-300"} ${v?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"John"}),a.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.firstName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.lastName,readOnly:!!v,onChange:s=>{v||(i({...r,lastName:s.target.value}),a.lastName&&p({...a,lastName:""}))},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.lastName?"border-red-500":"border-gray-300"} ${v?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Doe"}),a.lastName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee ID"}),e.jsx("input",{type:"text",value:r.employeeId,onChange:s=>i({...r,employeeId:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"EMP001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:r.department,readOnly:!!v,onChange:s=>{v||i({...r,department:s.target.value})},className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${v?"bg-gray-100 cursor-not-allowed":""}`,placeholder:"Sales, Warehouse, Accounting, etc."})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Module Access"}),e.jsx("span",{className:"text-sm text-red-500",children:"* At least one permission required"})]}),a.moduleAccess&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:a.moduleAccess})}),e.jsx("div",{className:"space-y-3",children:Object.entries(r.moduleAccess).filter(([s])=>s!=="accessControl").map(([s,t])=>{const m={sku:"SKU Management",accessControl:"Access Control",productCategory:"Product Category Access",itemCategory:"Item Category Access",subCategory:"Sub Category Access"}[s]||s.charAt(0).toUpperCase()+s.slice(1),h=r.role==="sales";if(!(!h||s==="sku"))return null;const f=h&&s==="sku";return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"font-medium text-gray-900 w-48",children:m})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.view,onChange:c=>{if(i({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,view:c.target.checked,create:c.target.checked&&!f?t.create:!1,edit:c.target.checked&&!f?t.edit:!1,delete:c.target.checked&&!f?t.delete:!1}}}),c.target.checked&&a.moduleAccess){const x={...a};delete x.moduleAccess,p(x)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"View"})]}),!f&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.create,disabled:!t.view,onChange:c=>{if(i({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,create:c.target.checked}}}),c.target.checked&&a.moduleAccess){const x={...a};delete x.moduleAccess,p(x)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:t.view?"text-gray-700":"text-gray-400",children:"Create"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.edit,disabled:!t.view,onChange:c=>{if(i({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,edit:c.target.checked}}}),c.target.checked&&a.moduleAccess){const x={...a};delete x.moduleAccess,p(x)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:t.view?"text-gray-700":"text-gray-400",children:"Edit"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.delete,disabled:!t.view,onChange:c=>{if(i({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,delete:c.target.checked}}}),c.target.checked&&a.moduleAccess){const x={...a};delete x.moduleAccess,p(x)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:t.view?"text-gray-700":"text-gray-400",children:"Delete"})]})]})]})]},s)})})]}),r.role==="admin"&&e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Category Access"}),e.jsxs("button",{onClick:te,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Category Access"]})]}),e.jsxs("div",{className:"space-y-4",children:[r.categoryAccess.map((s,t)=>{var g,m,h,u,f,c,x;return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Category Access ",t+1]}),e.jsx("button",{onClick:()=>le(t),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",title:"Remove",children:e.jsx(xe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Category"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:O.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No product categories available"}):O.map(l=>{var b;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.productCategoryIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:y=>{const n=[...r.categoryAccess],j=n[t].productCategoryIds||[];y.target.checked?n[t].productCategoryIds=[...j,String(l.id)]:(n[t].productCategoryIds=j.filter(o=>o!==String(l.id)),n[t].itemCategoryIds=[],n[t].subCategoryIds=[],n[t].itemIds=[]),i({...r,categoryAccess:n}),se(n[t].productCategoryIds)},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:l.name})]},l.id)})}),((g=s.productCategoryIds)==null?void 0:g.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.productCategoryIds.length," selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Category"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:D.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:((m=s.productCategoryIds)==null?void 0:m.length)>0?"No item categories available":"Select Product Category first"}):D.map(l=>{var b,y,n;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.itemCategoryIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:j=>{const o=[...r.categoryAccess],w=o[t].itemCategoryIds||[];j.target.checked?o[t].itemCategoryIds=[...w,String(l.id)]:(o[t].itemCategoryIds=w.filter(I=>I!==String(l.id)),o[t].subCategoryIds=[],o[t].itemIds=[]),i({...r,categoryAccess:o}),re(o[t].itemCategoryIds)},disabled:!((y=s.productCategoryIds)!=null&&y.length),className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:`text-sm ${(n=s.productCategoryIds)!=null&&n.length?"text-gray-700":"text-gray-400"}`,children:l.name})]},l.id)})}),((h=s.itemCategoryIds)==null?void 0:h.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.itemCategoryIds.length," selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sub Category"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:_.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:((u=s.itemCategoryIds)==null?void 0:u.length)>0?"No sub categories available":"Select Item Category first"}):_.map(l=>{var b,y,n;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.subCategoryIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:j=>{var I,d,C;const o=[...r.categoryAccess],w=o[t].subCategoryIds||[];j.target.checked?o[t].subCategoryIds=[...w,String(l.id)]:(o[t].subCategoryIds=w.filter(B=>B!==String(l.id)),o[t].itemIds=[]),i({...r,categoryAccess:o}),(I=o[t].productCategoryIds)!=null&&I.length&&((d=o[t].itemCategoryIds)!=null&&d.length)&&((C=o[t].subCategoryIds)!=null&&C.length)&&ae(o[t].productCategoryIds,o[t].itemCategoryIds,o[t].subCategoryIds)},disabled:!((y=s.itemCategoryIds)!=null&&y.length),className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:`text-sm ${(n=s.itemCategoryIds)!=null&&n.length?"text-gray-700":"text-gray-400"}`,children:l.name})]},l.id)})}),((f=s.subCategoryIds)==null?void 0:f.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.subCategoryIds.length," selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Name"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:V.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:((c=s.subCategoryIds)==null?void 0:c.length)>0?"No items available":"Select Sub Category first"}):V.map(l=>{var b,y,n;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.itemIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:j=>{const o=[...r.categoryAccess],w=o[t].itemIds||[];j.target.checked?o[t].itemIds=[...w,String(l.id)]:o[t].itemIds=w.filter(I=>I!==String(l.id)),i({...r,categoryAccess:o})},disabled:!((y=s.subCategoryIds)!=null&&y.length),className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:`text-sm ${(n=s.subCategoryIds)!=null&&n.length?"text-gray-700":"text-gray-400"}`,children:l.itemName||l.skuId})]},l.id)})}),((x=s.itemIds)==null?void 0:x.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.itemIds.length," selected"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),e.jsx("div",{className:"flex gap-4",children:["view","create","edit","delete"].map(l=>e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.permissions[l],onChange:b=>{const y=[...r.categoryAccess];if(y[t].permissions[l]=b.target.checked,i({...r,categoryAccess:y}),b.target.checked&&a[`categoryAccess_${t}`]){const n={...a};delete n[`categoryAccess_${t}`],p(n)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"capitalize text-gray-700",children:l})]},l))})]})]},t)}),r.categoryAccess.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-6 bg-gray-50 rounded-lg border border-gray-200",children:'No category access added. Click "Add Category Access" to add specific category permissions.'})]})]}),(r.firstName||r.lastName||r.email||r.role)&&e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Review Summary"}),e.jsxs("p",{className:"text-sm text-blue-800",children:[r.firstName||r.lastName?e.jsxs(e.Fragment,{children:[e.jsxs("strong",{children:[r.firstName," ",r.lastName]}),r.email&&e.jsxs(e.Fragment,{children:[" (",r.email,")"]})]}):r.email||"User"," ","will be invited as ",e.jsx("strong",{children:r.role||"selected role"}),r.department&&e.jsxs(e.Fragment,{children:[" in ",e.jsx("strong",{children:r.department})," department"]}),". Module access and category permissions as configured above."]})]})})]}),e.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 flex justify-between items-center",children:[e.jsx("button",{onClick:()=>U("/app/access-control"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ie,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Reset Form"}),e.jsx("button",{onClick:ee,disabled:q,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4"}),"Send Invitation"]})})]})]})]})]})};export{Ie as default};
