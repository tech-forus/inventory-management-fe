import{u as te,r as w,j as e,X as se}from"./index-v4UyLoar.js";import{b as re,v as $}from"./validators-CanHBN9q.js";import{a as I}from"./api-VNhYhLPD.js";import{A as ae}from"./arrow-left-CQGXFyIF.js";import{C as le}from"./check-circle-2-BoGtDVt5.js";import{U as z}from"./user-plus-CXkC_gI-.js";import{P as oe}from"./plus-DkwEl8bK.js";const xe=()=>{const F=te(),[M,R]=w.useState(!1),[J,k]=w.useState(!1),[K,A]=w.useState(""),[r,n]=w.useState({email:"",firstName:"",lastName:"",employeeId:"",role:"",department:"",moduleAccess:{dashboard:{view:!0,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:[]}),[U,T]=w.useState([]),[q,S]=w.useState([]),[L,E]=w.useState([]),[D,P]=w.useState([]),[a,p]=w.useState({});w.useEffect(()=>{I.get("/categories/product").then(s=>{T(s.data.data||[])}).catch(s=>{console.error("Error loading categories:",s)})},[]);const X=async()=>{var g,m,x,y,h,c,u,l,b,f,i,v,o,N,C;const s={};if(re(r.email)||(s.email="Valid email is required"),$(r.firstName)||(s.firstName="First Name is required"),$(r.lastName)||(s.lastName="Last Name is required"),$(r.role)||(s.role="Role is required"),Object.values(r.moduleAccess).some(d=>d.view||d.create||d.edit||d.delete)||(s.moduleAccess="At least one permission must be selected in Module Access"),r.categoryAccess.length>0&&r.categoryAccess.forEach((d,j)=>{var _,V,B,W;((_=d.permissions)==null?void 0:_.view)||((V=d.permissions)==null?void 0:V.create)||((B=d.permissions)==null?void 0:B.edit)||((W=d.permissions)==null?void 0:W.delete)||(s[`categoryAccess_${j}`]=`Category Access ${j+1}: At least one permission must be selected`)}),Object.keys(s).length>0){p(s);return}try{R(!0),await I.post("/users/invite",r),A(r.email),k(!0),n({email:"",firstName:"",lastName:"",employeeId:"",role:"",department:"",moduleAccess:{dashboard:{view:!0,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:[]}),p({}),setTimeout(()=>{k(!1),A("")},5e3)}catch(d){if(console.error("Error inviting user:",d),((g=d.response)==null?void 0:g.status)===409){const j=((x=(m=d.response)==null?void 0:m.data)==null?void 0:x.error)||((h=(y=d.response)==null?void 0:y.data)==null?void 0:h.message)||"User with this email already exists";alert(`Invitation failed: ${j}

Please use a different email address or check if this user has already been invited.`)}else if(((c=d.response)==null?void 0:c.status)===400){const j=((l=(u=d.response)==null?void 0:u.data)==null?void 0:l.error)||((f=(b=d.response)==null?void 0:b.data)==null?void 0:f.message)||"Invalid data provided";alert(`Invitation failed: ${j}

Please check all required fields and try again.`)}else if(((i=d.response)==null?void 0:i.status)===500)alert("Server error: Failed to send invitation. Please try again later or contact support.");else{const j=((o=(v=d.response)==null?void 0:v.data)==null?void 0:o.error)||((C=(N=d.response)==null?void 0:N.data)==null?void 0:C.message)||d.message||"Failed to send invitation";alert(`Invitation failed: ${j}`)}}finally{R(!1)}},Y=()=>{n({...r,categoryAccess:[...r.categoryAccess,{productCategoryIds:[],itemCategoryIds:[],subCategoryIds:[],itemIds:[],permissions:{view:!0,create:!0,edit:!0,delete:!0}}]})},G=async s=>{if(!s||s.length===0){S([]);return}try{const t=[];for(const m of s){const x=await I.get("/categories/item",{params:{productCategoryId:m}});t.push(...x.data.data||[])}const g=t.filter((m,x,y)=>x===y.findIndex(h=>h.id===m.id));S(g)}catch(t){console.error("Error loading item categories:",t),S([])}},H=async s=>{if(!s||s.length===0){E([]);return}try{const t=[];for(const m of s){const x=await I.get("/categories/sub",{params:{itemCategoryId:m}});t.push(...x.data.data||[])}const g=t.filter((m,x,y)=>x===y.findIndex(h=>h.id===m.id));E(g)}catch(t){console.error("Error loading sub categories:",t),E([])}},Q=async(s,t,g)=>{if(!(s!=null&&s.length)||!(t!=null&&t.length)||!(g!=null&&g.length)){P([]);return}try{const m=[];for(const y of s)for(const h of t)for(const c of g){const u=await I.get("/skus",{params:{productCategory:y,itemCategory:h,subCategory:c,limit:1e3}});m.push(...u.data.data||[])}const x=m.filter((y,h,c)=>h===c.findIndex(u=>u.id===y.id));P(x)}catch(m){console.error("Error loading items:",m),P([])}},Z=s=>{n({...r,categoryAccess:r.categoryAccess.filter((t,g)=>g!==s)})},ee=()=>{n({email:"",firstName:"",lastName:"",employeeId:"",role:"",department:"",moduleAccess:{dashboard:{view:!0,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:[]}),p({}),k(!1),A("")};return e.jsxs("div",{className:"p-6 space-y-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>F("/app/access-control"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Back to Access Control",children:e.jsx(ae,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Invite User"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Send an invitation to a new user to join the system"})]})]}),J&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(le,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-800 font-medium",children:"Invitation sent successfully!"}),e.jsxs("p",{className:"text-green-700 text-sm",children:["An invitation email has been sent to ",K||"the user","."]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:r.email,onChange:s=>{n({...r,email:s.target.value}),a.email&&p({...a,email:""})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.email?"border-red-500":"border-gray-300"}`,placeholder:"user@example.com"}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.role,onChange:s=>{const t=s.target.value;if(t==="admin")n({...r,role:t,moduleAccess:{dashboard:{view:!0,create:!0,edit:!0,delete:!0},sku:{view:!0,create:!0,edit:!0,delete:!0},inventory:{view:!0,create:!0,edit:!0,delete:!0},reports:{view:!0,create:!0,edit:!0,delete:!0},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!0,create:!0,edit:!0,delete:!0},itemCategory:{view:!0,create:!0,edit:!0,delete:!0},subCategory:{view:!0,create:!0,edit:!0,delete:!0}},categoryAccess:r.categoryAccess.length>0?r.categoryAccess:[]});else if(t==="sales")n({...r,role:t,moduleAccess:{dashboard:{view:!1,create:!1,edit:!1,delete:!1},sku:{view:!0,create:!1,edit:!1,delete:!1},inventory:{view:!1,create:!1,edit:!1,delete:!1},reports:{view:!1,create:!1,edit:!1,delete:!1},accessControl:{view:!1,create:!1,edit:!1,delete:!1},productCategory:{view:!1,create:!1,edit:!1,delete:!1},itemCategory:{view:!1,create:!1,edit:!1,delete:!1},subCategory:{view:!1,create:!1,edit:!1,delete:!1}},categoryAccess:[]});else if(t&&t!=="")if(window.confirm(`Are you sure you want to give access to ${t} role? You can configure specific permissions manually.`))n({...r,role:t});else{s.target.value=r.role;return}else n({...r,role:t});a.role&&p({...a,role:""})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.role?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"sales",children:"User"}),e.jsx("option",{value:"warehouse",disabled:!0,className:"opacity-50",children:"Warehouse"}),e.jsx("option",{value:"accountant",disabled:!0,className:"opacity-50",children:"Accountant"})]}),a.role&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.role})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.firstName,onChange:s=>{n({...r,firstName:s.target.value}),a.firstName&&p({...a,firstName:""})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.firstName?"border-red-500":"border-gray-300"}`,placeholder:"John"}),a.firstName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.firstName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.lastName,onChange:s=>{n({...r,lastName:s.target.value}),a.lastName&&p({...a,lastName:""})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${a.lastName?"border-red-500":"border-gray-300"}`,placeholder:"Doe"}),a.lastName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee ID"}),e.jsx("input",{type:"text",value:r.employeeId,onChange:s=>n({...r,employeeId:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"EMP001"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:r.department,onChange:s=>n({...r,department:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Sales, Warehouse, Accounting, etc."})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Module Access"}),e.jsx("span",{className:"text-sm text-red-500",children:"* At least one permission required"})]}),a.moduleAccess&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:a.moduleAccess})}),e.jsx("div",{className:"space-y-3",children:Object.entries(r.moduleAccess).filter(([s])=>s!=="accessControl").map(([s,t])=>{const m={sku:"SKU Management",accessControl:"Access Control",productCategory:"Product Category Access",itemCategory:"Item Category Access",subCategory:"Sub Category Access"}[s]||s.charAt(0).toUpperCase()+s.slice(1),x=r.role==="sales";if(!(!x||s==="sku"))return null;const h=x&&s==="sku";return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"font-medium text-gray-900 w-48",children:m})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.view,onChange:c=>{if(n({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,view:c.target.checked,create:c.target.checked&&!h?t.create:!1,edit:c.target.checked&&!h?t.edit:!1,delete:c.target.checked&&!h?t.delete:!1}}}),c.target.checked&&a.moduleAccess){const u={...a};delete u.moduleAccess,p(u)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:"View"})]}),!h&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.create,disabled:!t.view,onChange:c=>{if(n({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,create:c.target.checked}}}),c.target.checked&&a.moduleAccess){const u={...a};delete u.moduleAccess,p(u)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:t.view?"text-gray-700":"text-gray-400",children:"Create"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.edit,disabled:!t.view,onChange:c=>{if(n({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,edit:c.target.checked}}}),c.target.checked&&a.moduleAccess){const u={...a};delete u.moduleAccess,p(u)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:t.view?"text-gray-700":"text-gray-400",children:"Edit"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.delete,disabled:!t.view,onChange:c=>{if(n({...r,moduleAccess:{...r.moduleAccess,[s]:{...t,delete:c.target.checked}}}),c.target.checked&&a.moduleAccess){const u={...a};delete u.moduleAccess,p(u)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:t.view?"text-gray-700":"text-gray-400",children:"Delete"})]})]})]})]},s)})})]}),r.role==="admin"&&e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Category Access"}),e.jsxs("button",{onClick:Y,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"Add Category Access"]})]}),e.jsxs("div",{className:"space-y-4",children:[r.categoryAccess.map((s,t)=>{var g,m,x,y,h,c,u;return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Category Access ",t+1]}),e.jsx("button",{onClick:()=>Z(t),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded transition-colors",title:"Remove",children:e.jsx(se,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Category"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:U.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No product categories available"}):U.map(l=>{var b;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.productCategoryIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:f=>{const i=[...r.categoryAccess],v=i[t].productCategoryIds||[];f.target.checked?i[t].productCategoryIds=[...v,String(l.id)]:(i[t].productCategoryIds=v.filter(o=>o!==String(l.id)),i[t].itemCategoryIds=[],i[t].subCategoryIds=[],i[t].itemIds=[]),n({...r,categoryAccess:i}),G(i[t].productCategoryIds)},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:l.name})]},l.id)})}),((g=s.productCategoryIds)==null?void 0:g.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.productCategoryIds.length," selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Category"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:q.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:((m=s.productCategoryIds)==null?void 0:m.length)>0?"No item categories available":"Select Product Category first"}):q.map(l=>{var b,f,i;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.itemCategoryIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:v=>{const o=[...r.categoryAccess],N=o[t].itemCategoryIds||[];v.target.checked?o[t].itemCategoryIds=[...N,String(l.id)]:(o[t].itemCategoryIds=N.filter(C=>C!==String(l.id)),o[t].subCategoryIds=[],o[t].itemIds=[]),n({...r,categoryAccess:o}),H(o[t].itemCategoryIds)},disabled:!((f=s.productCategoryIds)!=null&&f.length),className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:`text-sm ${(i=s.productCategoryIds)!=null&&i.length?"text-gray-700":"text-gray-400"}`,children:l.name})]},l.id)})}),((x=s.itemCategoryIds)==null?void 0:x.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.itemCategoryIds.length," selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sub Category"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:L.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:((y=s.itemCategoryIds)==null?void 0:y.length)>0?"No sub categories available":"Select Item Category first"}):L.map(l=>{var b,f,i;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.subCategoryIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:v=>{var C,d,j;const o=[...r.categoryAccess],N=o[t].subCategoryIds||[];v.target.checked?o[t].subCategoryIds=[...N,String(l.id)]:(o[t].subCategoryIds=N.filter(O=>O!==String(l.id)),o[t].itemIds=[]),n({...r,categoryAccess:o}),(C=o[t].productCategoryIds)!=null&&C.length&&((d=o[t].itemCategoryIds)!=null&&d.length)&&((j=o[t].subCategoryIds)!=null&&j.length)&&Q(o[t].productCategoryIds,o[t].itemCategoryIds,o[t].subCategoryIds)},disabled:!((f=s.itemCategoryIds)!=null&&f.length),className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:`text-sm ${(i=s.itemCategoryIds)!=null&&i.length?"text-gray-700":"text-gray-400"}`,children:l.name})]},l.id)})}),((h=s.subCategoryIds)==null?void 0:h.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.subCategoryIds.length," selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Name"}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto bg-white",children:D.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:((c=s.subCategoryIds)==null?void 0:c.length)>0?"No items available":"Select Sub Category first"}):D.map(l=>{var b,f,i;return e.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer hover:bg-gray-50 rounded px-2",children:[e.jsx("input",{type:"checkbox",checked:((b=s.itemIds)==null?void 0:b.includes(String(l.id)))||!1,onChange:v=>{const o=[...r.categoryAccess],N=o[t].itemIds||[];v.target.checked?o[t].itemIds=[...N,String(l.id)]:o[t].itemIds=N.filter(C=>C!==String(l.id)),n({...r,categoryAccess:o})},disabled:!((f=s.subCategoryIds)!=null&&f.length),className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:`text-sm ${(i=s.subCategoryIds)!=null&&i.length?"text-gray-700":"text-gray-400"}`,children:l.itemName||l.skuId})]},l.id)})}),((u=s.itemIds)==null?void 0:u.length)>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.itemIds.length," selected"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),e.jsx("div",{className:"flex gap-4",children:["view","create","edit","delete"].map(l=>e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.permissions[l],onChange:b=>{const f=[...r.categoryAccess];if(f[t].permissions[l]=b.target.checked,n({...r,categoryAccess:f}),b.target.checked&&a[`categoryAccess_${t}`]){const i={...a};delete i[`categoryAccess_${t}`],p(i)}},className:"w-4 h-4 rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"capitalize text-gray-700",children:l})]},l))})]})]},t)}),r.categoryAccess.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-6 bg-gray-50 rounded-lg border border-gray-200",children:'No category access added. Click "Add Category Access" to add specific category permissions.'})]})]}),(r.firstName||r.lastName||r.email||r.role)&&e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Review Summary"}),e.jsxs("p",{className:"text-sm text-blue-800",children:[r.firstName||r.lastName?e.jsxs(e.Fragment,{children:[e.jsxs("strong",{children:[r.firstName," ",r.lastName]}),r.email&&e.jsxs(e.Fragment,{children:[" (",r.email,")"]})]}):r.email||"User"," ","will be invited as ",e.jsx("strong",{children:r.role||"selected role"}),r.department&&e.jsxs(e.Fragment,{children:[" in ",e.jsx("strong",{children:r.department})," department"]}),". Module access and category permissions as configured above."]})]})})]}),e.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 flex justify-between items-center",children:[e.jsx("button",{onClick:()=>F("/app/access-control"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ee,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Reset Form"}),e.jsx("button",{onClick:X,disabled:M,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:M?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4"}),"Send Invitation"]})})]})]})]})]})};export{xe as default};
