import{c as L,r as g,j as t,F as B}from"./index-v4UyLoar.js";import{s as f}from"./skuService-CD47JNeC.js";import{i as v}from"./inventoryService-3mhiX-ga.js";import{g as T,a as H,e as $,f as C}from"./reportExporter-C58px7xM.js";import{a as p,f as m,b as u}from"./formatters-ptPrPoGe.js";import{C as A}from"./calendar-DZNgaMIm.js";import{F as z}from"./filter-B2wwtLHs.js";import"./api-VNhYhLPD.js";import"./cachedApi-CKq13PPM.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=L("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),ae=()=>{const[w,F]=g.useState("total-skus"),[d,S]=g.useState(6),[x,j]=g.useState(""),[h,D]=g.useState(""),[b,I]=g.useState(!1),[y,k]=g.useState(!1);g.useEffect(()=>{if(d!=="custom"){const e=T(d);j(e.dateFrom),D(e.dateTo)}},[d]);const R=async()=>{try{I(!0);let e="",o=x,l=h;if(d==="custom")e=C(x,h);else{const n=T(d);o=n.dateFrom,l=n.dateTo,e=C(n.dateFrom,n.dateTo)}switch(w){case"total-skus":return await U(e);case"in-out-inventory":return await M(e,o,l);case"dead-inventory":return await P(e);case"most-selling":return await E(e);case"rejected-item":return await K(e,o,l);default:return null}}catch(e){return console.error("Error generating report:",e),alert("Error generating report. Please try again."),null}finally{I(!1)}},U=async e=>{const l=(await f.getAll({limit:1e4})).data||[],n=["SKU ID","Item Name","Brand","Category","Current Stock","Min Stock","Available Stock","Unit Price","Total Value"],c=l.map(r=>[r.skuId||"-",r.itemName||"-",r.brand||"-",r.productCategory||"-",m(r.currentStock||0),m(r.minStock||0),m(r.usefulStocks||(r.currentStock||0)-(r.bookStocks||0)),u(r.unitPrice||0),u((r.currentStock||0)*(r.unitPrice||0))]);return{headers:n,rows:c,title:"Total SKUs Report",dateRange:e}},M=async(e,o,l)=>{const[n,c]=await Promise.all([v.getIncomingHistory({dateFrom:o,dateTo:l}),v.getOutgoingHistory({dateFrom:o,dateTo:l})]),r=n.data||[],a=c.data||[],i=["Type","Invoice Number","Date","Vendor","Brand","Total Items","Total Value","Status"],N=[];return r.forEach(s=>{N.push(["INCOMING",s.invoiceNumber||"-",p(s.invoiceDate||s.receivingDate),s.vendorName||"-",s.brandName||"-",m(s.totalItems||0),u(s.totalValue||0),s.status||"-"])}),a.forEach(s=>{N.push(["OUTGOING",s.invoiceNumber||s.docketNumber||"-",p(s.date),s.destination||"-","-",m(s.totalItems||0),u(s.totalValue||0),s.status||"-"])}),{headers:i,rows:N,title:"IN/OUT Inventory Report",dateRange:e}},P=async e=>{const o=d==="custom"?6:d,n=(await f.getNonMovable({period:o})).data||[],c=["SKU ID","Item Name","Brand","Category","Current Stock","Unit Price","Inventory Value","Last Sale Date","Aging (Days)"],r=n.map(a=>[a.skuId||"-",a.itemName||"-",a.brand||"-",a.category||"-",m(a.currentStock||0),u(a.unitPrice||0),u(a.inventoryValue||0),a.lastSaleDate?p(a.lastSaleDate):"Never",m(a.aging||0)]);return{headers:c,rows:r,title:"Dead Inventory (Non-Movable SKUs) Report",dateRange:e}},E=async e=>{const o=d==="custom"?30:d*30,n=(await f.getMostSelling({period:o,sortBy:"units"})).data||[],c=["Rank","SKU ID","Item Name","Category","Units Sold","Revenue","Last Sale Date"],r=n.map((a,i)=>[i+1,a.skuId||"-",a.itemName||"-",a.category||"-",m(a.unitsSold||0),u(a.revenue||0),a.lastSaleDate?p(a.lastSaleDate):"-"]);return{headers:c,rows:r,title:"Most Selling SKUs Report",dateRange:e}},K=async(e,o,l)=>{const c=(await v.getRejectedItemReports({dateFrom:o,dateTo:l})).data||[],r=["Report No.","Inspection Date","SKU ID","Item Name","Quantity","Status","Original Invoice"],a=c.map(i=>[i.reportNumber||"-",p(i.inspectionDate),i.skuCode||`SKU-${i.skuId}`,i.itemName||"-",m(i.quantity||0),i.status||"Pending",i.originalInvoiceNumber||"-"]);return{headers:r,rows:a,title:"Rejected Item Report",dateRange:e}},O=async()=>{const e=await R();e&&await H(e)},V=async()=>{const e=await R();e&&await $(e)},G=[{id:"total-skus",label:"Total SKUs"},{id:"in-out-inventory",label:"IN/OUT Inventory"},{id:"dead-inventory",label:"Dead Inventory"},{id:"most-selling",label:"Most Selling SKUs"},{id:"rejected-item",label:"Rejected Item"}];return t.jsx("div",{className:"p-4 bg-gray-50 min-h-screen",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Reports"}),t.jsx("p",{className:"text-gray-600",children:"Generate and download reports in PDF or Excel format"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4",children:[t.jsx("h2",{className:"text-base font-semibold text-gray-900 mb-3",children:"Select Report Type"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:G.map(e=>t.jsx("button",{onClick:()=>F(e.id),className:`px-3 py-2 text-sm rounded-lg border-2 transition-all ${w===e.id?"border-blue-500 bg-blue-50 text-blue-700 font-semibold":"border-gray-200 bg-white text-gray-700 hover:border-gray-300 hover:bg-gray-50"}`,children:e.label},e.id))})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx(A,{className:"w-5 h-5"}),"Date Range"]}),t.jsxs("button",{onClick:()=>k(!y),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[t.jsx(z,{className:"w-4 h-4"}),y?"Hide":"Show"," Custom Dates"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[[1,3,6,12].map(e=>t.jsxs("button",{onClick:()=>S(e),className:`px-3 py-1.5 text-sm rounded-lg border-2 transition-all ${d===e?"border-blue-500 bg-blue-50 text-blue-700 font-semibold":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[e," Month",e>1?"s":""]},e)),t.jsx("button",{onClick:()=>S("custom"),className:`px-4 py-2 rounded-lg border-2 transition-all ${d==="custom"?"border-blue-500 bg-blue-50 text-blue-700 font-semibold":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:"Custom"})]}),y&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),t.jsx("input",{type:"date",value:x,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),t.jsx("input",{type:"date",value:h,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[t.jsx("h2",{className:"text-base font-semibold text-gray-900 mb-3",children:"Export Options"}),t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("button",{onClick:O,disabled:b,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[t.jsx(B,{className:"w-5 h-5"}),b?"Generating...":"Download PDF"]}),t.jsxs("button",{onClick:V,disabled:b,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[t.jsx(q,{className:"w-5 h-5"}),b?"Generating...":"Download Excel"]})]}),b&&t.jsxs("div",{className:"mt-4 flex items-center gap-2 text-gray-600",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-sm",children:"Loading report data..."})]})]})]})})};export{ae as default};
