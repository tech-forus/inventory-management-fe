import{u as ie,r as c,j as e,X as K}from"./index-v4UyLoar.js";import{i as $}from"./inventoryService-3mhiX-ga.js";import{s as de}from"./skuService-CD47JNeC.js";import{l as V}from"./libraryService-BqxRzzIS.js";import{f as N,a as ce,b as ue}from"./formatters-ptPrPoGe.js";import{A as xe}from"./arrow-left-CQGXFyIF.js";import{P as me}from"./plus-DkwEl8bK.js";import{C as ge}from"./chevron-down-DTzR0Snc.js";import{S as pe}from"./save-4D8tpIMf.js";import"./api-VNhYhLPD.js";import"./cachedApi-CKq13PPM.js";const Ce=()=>{const _=ie(),[f,P]=c.useState("add"),[S,w]=c.useState(!1),E=()=>({id:Date.now().toString(),skuId:"",itemName:"",currentStock:0,originalStock:0,outgoingQuantity:0,unitPrice:0,totalValue:0}),[a,i]=c.useState({documentType:"sales_invoice",documentSubType:"",vendorSubType:"",deliveryChallanSubType:"",invoiceChallanDate:new Date().toISOString().split("T")[0],invoiceChallanNumber:"",docketNumber:"",transportorName:"",destinationType:"customer",destinationId:"",dispatchedBy:"",remarks:"",items:[E()]}),[g,q]=c.useState([]),[R,B]=c.useState([]),[H,z]=c.useState([]),[X,Y]=c.useState([]),[O,F]=c.useState([]),[b,h]=c.useState({}),[Q,v]=c.useState({}),[k,x]=c.useState({}),[T,G]=c.useState(""),[C,J]=c.useState(""),[I,M]=c.useState(""),[D,W]=c.useState("");c.useEffect(()=>{Z()},[]),c.useEffect(()=>{f==="history"&&ee()},[f,T,C,I,D]),c.useEffect(()=>{const t=s=>{s.target.closest(".sku-dropdown-container")||(v({}),h(n=>{const l={};return Object.keys(n).forEach(o=>{const d=a.items.find(u=>u.id===o);if(d!=null&&d.skuId){const u=g.find(p=>p.id.toString()===d.skuId);(u==null?void 0:u.skuId)===n[o]&&(l[o]=n[o])}}),l}))};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[a.items,g]),c.useEffect(()=>{a.documentType==="transfer_note"?i(t=>({...t,documentSubType:"",vendorSubType:"",deliveryChallanSubType:"",destinationType:"store_to_factory",destinationId:""})):i(t=>({...t,documentSubType:"",vendorSubType:"",deliveryChallanSubType:"",destinationType:(t.documentType==="sales_invoice","customer"),destinationId:""})),x({})},[a.documentType]),c.useEffect(()=>{a.documentType==="sales_invoice"?a.documentSubType==="to_customer"?i(t=>({...t,destinationType:"customer",vendorSubType:"",destinationId:""})):a.documentSubType==="to_vendor"&&i(t=>({...t,destinationType:"vendor",destinationId:""})):a.documentType==="delivery_challan"&&(a.documentSubType==="sample"?i(t=>({...t,destinationType:"customer",deliveryChallanSubType:"",destinationId:""})):a.documentSubType==="replacement"&&i(t=>({...t,destinationId:""}))),x({})},[a.documentSubType]),c.useEffect(()=>{a.documentType==="delivery_challan"&&a.documentSubType==="replacement"&&(a.deliveryChallanSubType==="to_customer"?i(t=>({...t,destinationType:"customer",destinationId:""})):a.deliveryChallanSubType==="to_vendor"&&i(t=>({...t,destinationType:"vendor",destinationId:""}))),x({})},[a.deliveryChallanSubType]);const Z=async()=>{try{const[t,s,r,n]=await Promise.all([de.getAll({limit:1e3}),V.getCustomers(),V.getYourVendors(),V.getTeams()]);q(t.data||[]),B(s.data||[]),z(r.data||[]),Y(n.data||[])}catch(t){console.error("Error loading initial data:",t)}},ee=async()=>{try{w(!0);const t={};T&&(t.dateFrom=T),C&&(t.dateTo=C),I&&(t.destination=I),D&&(t.sku=D);const s=await $.getOutgoingHistory(t);F(s.data||[])}catch(t){console.error("Error loading history:",t),F([])}finally{w(!1)}},te=()=>{const t=E();i(s=>({...s,items:[...s.items,t]}))},se=t=>{i(s=>{const r=s.items.filter(n=>n.id!==t);return r.length===0?{...s,items:[E()]}:{...s,items:r}})},m=()=>a.documentType==="delivery_challan"&&a.documentSubType==="replacement"&&a.deliveryChallanSubType==="to_vendor",y=(t,s,r)=>{i(n=>({...n,items:n.items.map(l=>{if(l.id===t){const o={...l,[s]:r};if(s==="skuId"){const d=g.find(u=>u.id.toString()===r);o.itemName=(d==null?void 0:d.itemName)||"",o.originalStock=(d==null?void 0:d.currentStock)||0,o.currentStock=(d==null?void 0:d.currentStock)||0,o.outgoingQuantity=0,x(u=>{const p={...u};return delete p[l.id],p})}if(s==="outgoingQuantity"){const d=parseInt(r)||0;if(m())o.outgoingQuantity=d,x(p=>{const j={...p};return delete j[l.id],j});else{const p=o.originalStock;if(d>p)return x(j=>({...j,[l.id]:`Outgoing quantity cannot exceed available stock (${p})`})),l;x(j=>{const U={...j};return delete U[l.id],U}),o.outgoingQuantity=d,o.currentStock=o.originalStock-d}o.totalValue=o.outgoingQuantity*o.unitPrice}return s==="unitPrice"&&(o.totalValue=o.outgoingQuantity*o.unitPrice),o}return l})}))},ae=()=>{const t={},s=m();return a.items.forEach(r=>{r.skuId&&!s&&r.outgoingQuantity>r.originalStock&&(t[r.id]=`Outgoing quantity cannot exceed available stock (${r.originalStock})`)}),x(t),Object.keys(t).length===0},A=async(t=!1)=>{var s,r;if(!t&&!ae()){alert("Please fix validation errors before submitting.");return}try{w(!0);const n={...a,items:a.items.map(l=>({skuId:l.skuId,outgoingQuantity:l.outgoingQuantity,unitPrice:l.unitPrice})),status:t?"draft":"completed"};await $.addOutgoing(n),_("/app/inventory")}catch(n){console.error("Error submitting outgoing inventory:",n),alert(((r=(s=n.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to submit outgoing inventory")}finally{w(!1)}},re=t=>t>10?"text-green-600":t>0?"text-yellow-600":"text-red-600",ne=()=>a.documentType==="sales_invoice"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Type"}),e.jsxs("select",{value:a.documentSubType,onChange:t=>i(s=>({...s,documentSubType:t.target.value,vendorSubType:""})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"to_customer",children:"To Customer"}),e.jsx("option",{value:"to_vendor",children:"To Vendor"})]})]}):a.documentType==="delivery_challan"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Type"}),e.jsxs("select",{value:a.documentSubType,onChange:t=>i(s=>({...s,documentSubType:t.target.value,deliveryChallanSubType:""})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"sample",children:"Sample"}),e.jsx("option",{value:"replacement",children:"Replacement"})]})]}):a.documentType==="transfer_note"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transfer Type"}),e.jsx("input",{type:"text",value:"Store to Factory",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}):null,le=()=>a.documentType==="sales_invoice"&&a.documentSubType==="to_vendor"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendor Type"}),e.jsxs("select",{value:a.vendorSubType,onChange:t=>i(s=>({...s,vendorSubType:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"replacement",children:"Replacement"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}):null,oe=()=>a.documentType==="delivery_challan"&&a.documentSubType==="replacement"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Replacement Type"}),e.jsxs("select",{value:a.deliveryChallanSubType,onChange:t=>i(s=>({...s,deliveryChallanSubType:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"to_customer",children:"To Customer"}),e.jsx("option",{value:"to_vendor",children:"To Vendor (Return to Vendor)"})]})]}):null,L=()=>a.documentType==="transfer_note"?null:a.documentType==="delivery_challan"&&a.documentSubType==="sample"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer"}),e.jsxs("select",{value:a.destinationId,onChange:t=>i(s=>({...s,destinationId:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Customer"}),R.map(t=>e.jsx("option",{value:t.id,children:t.customerName||t.name},t.id))]})]}):a.destinationType==="customer"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer"}),e.jsxs("select",{value:a.destinationId,onChange:t=>i(s=>({...s,destinationId:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Customer"}),R.map(t=>e.jsx("option",{value:t.id,children:t.customerName||t.name},t.id))]})]}):a.destinationType==="vendor"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vendor"}),e.jsxs("select",{value:a.destinationId,onChange:t=>i(s=>({...s,destinationId:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Vendor"}),H.map(t=>e.jsx("option",{value:t.id,children:t.name||t.vendorName},t.id))]})]}):null;return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>_("/app/inventory"),className:"text-gray-600 hover:text-gray-900",children:e.jsx(xe,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Outgoing Inventory"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>P("add"),className:`py-4 px-1 border-b-2 font-medium text-sm ${f==="add"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Add New"}),e.jsx("button",{onClick:()=>P("history"),className:`py-4 px-1 border-b-2 font-medium text-sm ${f==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"History"})]})}),f==="add"&&e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Document Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Document Type"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>i(t=>({...t,documentType:"sales_invoice"})),children:[e.jsx("input",{type:"radio",name:"documentType",value:"sales_invoice",checked:a.documentType==="sales_invoice",onChange:t=>i(s=>({...s,documentType:t.target.value})),className:"text-blue-600 cursor-pointer"}),e.jsx("span",{className:"cursor-pointer",children:"Sales Invoice"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>i(t=>({...t,documentType:"delivery_challan"})),children:[e.jsx("input",{type:"radio",name:"documentType",value:"delivery_challan",checked:a.documentType==="delivery_challan",onChange:t=>i(s=>({...s,documentType:t.target.value})),className:"text-blue-600 cursor-pointer"}),e.jsx("span",{className:"cursor-pointer",children:"Delivery Challan"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>i(t=>({...t,documentType:"transfer_note"})),children:[e.jsx("input",{type:"radio",name:"documentType",value:"transfer_note",checked:a.documentType==="transfer_note",onChange:t=>i(s=>({...s,documentType:t.target.value})),className:"text-blue-600 cursor-pointer"}),e.jsx("span",{className:"cursor-pointer",children:"Transfer Note"})]})]})]}),e.jsxs("div",{children:[ne(),le(),oe()]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Document Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice/Challan Date"}),e.jsx("input",{type:"date",value:a.invoiceChallanDate,onChange:t=>i(s=>({...s,invoiceChallanDate:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice/Challan Number"}),e.jsx("input",{type:"text",value:a.invoiceChallanNumber,onChange:t=>i(s=>({...s,invoiceChallanNumber:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter invoice/challan number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Docket Number"}),e.jsx("input",{type:"text",value:a.docketNumber,onChange:t=>i(s=>({...s,docketNumber:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter docket number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transportor Name"}),e.jsx("input",{type:"text",value:a.transportorName,onChange:t=>i(s=>({...s,transportorName:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter transportor name"})]})]})]}),L()&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Destination"}),L()]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Item Details"}),e.jsxs("button",{type:"button",onClick:te,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Add Item"]})]}),e.jsxs("div",{className:"space-y-3",children:[a.items.map(t=>{var s;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 pb-1",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-700 min-w-[2rem]",children:["#",a.items.indexOf(t)+1]}),a.items.length>1&&e.jsx("button",{type:"button",onClick:()=>se(t.id),className:"text-red-600 hover:text-red-800",title:"Remove Item",children:e.jsx(K,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex-1 relative sku-dropdown-container min-w-[200px]",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"SKU"}),e.jsx("div",{className:"flex gap-1.5 items-start",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsxs("div",{className:"flex gap-0.5",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:b[t.id]||t.skuId&&((s=g.find(r=>r.id.toString()===t.skuId))==null?void 0:s.skuId)||"",onChange:r=>{h(n=>({...n,[t.id]:r.target.value})),v(n=>({...n,[t.id]:!1})),r.target.value||y(t.id,"skuId","")},onFocus:()=>{const r=g.find(n=>n.id.toString()===t.skuId);h(n=>({...n,[t.id]:(r==null?void 0:r.skuId)||""}))},placeholder:"Search SKU...",className:"w-full px-2.5 py-1.5 pr-8 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"}),(b[t.id]||t.skuId)&&e.jsx("button",{type:"button",onClick:r=>{r.stopPropagation(),h(n=>({...n,[t.id]:""})),y(t.id,"skuId",""),v(n=>({...n,[t.id]:!1}))},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(K,{className:"w-3 h-3"})})]}),e.jsx("button",{type:"button",onClick:r=>{r.stopPropagation(),v(n=>({...n,[t.id]:!n[t.id]})),h(n=>({...n,[t.id]:""}))},className:"px-2 py-1.5 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 border border-gray-300",title:"Show all SKUs",children:e.jsx(ge,{className:`w-3.5 h-3.5 transition-transform ${Q[t.id]?"rotate-180":""}`})})]}),b[t.id]&&b[t.id].length>0&&!Q[t.id]&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[g.filter(r=>{var n,l;return((n=r.skuId)==null?void 0:n.toLowerCase().includes(b[t.id].toLowerCase()))||((l=r.itemName)==null?void 0:l.toLowerCase().includes(b[t.id].toLowerCase()))}).slice(0,10).map(r=>e.jsxs("div",{onClick:n=>{n.stopPropagation(),y(t.id,"skuId",r.id.toString()),h(l=>{const o={...l};return delete o[t.id],o}),v(l=>({...l,[t.id]:!1}))},className:"px-3 py-2 text-xs hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium",children:r.skuId}),r.itemName&&e.jsx("div",{className:"text-gray-500 text-xs",children:r.itemName})]},r.id)),g.filter(r=>{var n,l;return((n=r.skuId)==null?void 0:n.toLowerCase().includes(b[t.id].toLowerCase()))||((l=r.itemName)==null?void 0:l.toLowerCase().includes(b[t.id].toLowerCase()))}).length===0&&e.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No SKUs found"})]}),Q[t.id]&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:g.length===0?e.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No SKUs available"}):g.map(r=>e.jsxs("div",{onClick:n=>{n.stopPropagation(),y(t.id,"skuId",r.id.toString()),h(l=>{const o={...l};return delete o[t.id],o}),v(l=>({...l,[t.id]:!1}))},className:`px-3 py-2 text-xs hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 ${t.skuId===r.id.toString()?"bg-blue-50":""}`,children:[e.jsx("div",{className:"font-medium",children:r.skuId}),r.itemName&&e.jsx("div",{className:"text-gray-500 text-xs",children:r.itemName})]},r.id))})]})})]}),e.jsx("div",{className:"w-px h-12 bg-gray-300"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:m()?"Rejected Qty":"Available Stock"}),e.jsx("div",{className:`px-2 py-1.5 text-xs border border-gray-300 rounded bg-gray-50 font-semibold ${re(t.currentStock)}`,children:m()?N(t.outgoingQuantity):N(t.currentStock)})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Outgoing Qty"}),e.jsx("input",{type:"number",min:"0",max:m()?void 0:t.originalStock,value:t.outgoingQuantity,onChange:r=>{const n=r.target.value;if(n===""){y(t.id,"outgoingQuantity","0");return}const l=parseInt(n);if(isNaN(l)||l<0)return;const o=m(),d=o?void 0:t.originalStock;if(!o&&d!==void 0&&l>d){x(u=>({...u,[t.id]:`Outgoing quantity cannot exceed available stock (${d})`}));return}y(t.id,"outgoingQuantity",n)},onBlur:r=>{const n=parseInt(r.target.value)||0;!m()&&n>t.originalStock&&(y(t.id,"outgoingQuantity",t.originalStock.toString()),x(o=>({...o,[t.id]:`Outgoing quantity cannot exceed available stock (${t.originalStock})`})))},className:`w-full px-2 py-1.5 text-xs border rounded focus:ring-1 focus:ring-blue-500 ${k[t.id]||!m()&&t.outgoingQuantity>t.originalStock?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"0"}),k[t.id]&&e.jsx("p",{className:"text-xs text-red-600 mt-0.5",children:k[t.id]})]})]}),e.jsx("div",{className:"w-px h-12 bg-gray-300"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit Price"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.unitPrice,onChange:r=>y(t.id,"unitPrice",parseFloat(r.target.value)||0),className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"0"})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Total Value"}),e.jsx("input",{type:"text",value:t.totalValue.toFixed(2),readOnly:!0,className:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded bg-gray-50"})]})]})]})},t.id)}),a.items.length>0&&e.jsx("div",{className:"border-2 border-blue-300 rounded-lg p-3 bg-blue-50",children:e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsx("div",{className:"flex items-center gap-1.5 pb-1 min-w-[2rem]",children:e.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Total"})}),e.jsx("div",{className:"flex-1 relative min-w-[200px]"}),e.jsx("div",{className:"w-px h-12 bg-gray-300"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:m()?"Rejected Qty":"Available Stock"}),e.jsx("div",{className:"px-2 py-1.5 text-xs border-2 border-blue-500 rounded bg-white font-bold text-gray-900",children:m()?N(a.items.reduce((t,s)=>t+(s.outgoingQuantity||0),0)):N(a.items.reduce((t,s)=>t+(s.currentStock||0),0))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Outgoing Qty"}),e.jsx("div",{className:"px-2 py-1.5 text-xs border-2 border-blue-500 rounded bg-white font-bold text-gray-900",children:N(a.items.reduce((t,s)=>t+(s.outgoingQuantity||0),0))})]})]}),e.jsx("div",{className:"w-px h-12 bg-gray-300"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit Price"}),e.jsx("div",{className:"px-2 py-1.5 text-xs border-2 border-blue-500 rounded bg-white font-bold text-gray-900",children:a.items.length>0?(a.items.reduce((t,s)=>t+(s.unitPrice||0),0)/a.items.length).toFixed(2):"0.00"})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Total Value"}),e.jsx("div",{className:"px-2 py-1.5 text-xs border-2 border-blue-500 rounded bg-white font-bold text-gray-900",children:a.items.reduce((t,s)=>t+(s.totalValue||0),0).toFixed(2)})]})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Additional Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dispatched By"}),e.jsxs("select",{value:a.dispatchedBy,onChange:t=>i(s=>({...s,dispatchedBy:t.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Team"}),X.map(t=>e.jsx("option",{value:t.id,children:t.name||t.teamName},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{value:a.remarks,onChange:t=>i(s=>({...s,remarks:t.target.value})),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter any additional remarks"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>_("/app/inventory"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>A(!0),disabled:S,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50",children:"Save as Draft"}),e.jsx("button",{type:"button",onClick:()=>A(!1),disabled:S||a.items.length===0||Object.keys(k).length>0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-5 h-5"}),"Submit"]})})]})]}),f==="history"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),e.jsx("input",{type:"date",value:T,onChange:t=>G(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),e.jsx("input",{type:"date",value:C,onChange:t=>J(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),e.jsx("input",{type:"text",value:I,onChange:t=>M(t.target.value),placeholder:"Search destination",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU"}),e.jsx("input",{type:"text",value:D,onChange:t=>W(t.target.value),placeholder:"Search SKU",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Document #"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"SKU"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})})})}):O.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No history found"})}):O.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:ce(t.date)}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:t.documentNumber||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 capitalize",children:((s=t.documentType)==null?void 0:s.replace(/_/g," "))||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.destination||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.sku||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:N(t.quantity||0)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:ue(t.value||0)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:"View"})})]},t.id)})})]})})})]})]})};export{Ce as default};
