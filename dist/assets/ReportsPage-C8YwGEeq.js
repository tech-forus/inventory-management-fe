import{c as C,r as x,j as t,F as B}from"./index-BNvq7L73.js";import{s as w}from"./skuService-BaVM3Gme.js";import{i as N}from"./inventoryService-B58imFTr.js";import{g as R,a as H,e as $,f as T}from"./reportExporter-SrrsgYv8.js";import{a as u,f as p,b as m}from"./formatters-ptPrPoGe.js";import{C as A}from"./calendar-jJopjIGz.js";import"./api-BJ7xcL-N.js";import"./cachedApi-DyAQX7TM.js";import"./inventoryEvents-fOALNsvn.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=C("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=C("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ae=()=>{const[v,F]=x.useState("total-skus"),[c,S]=x.useState(6),[b,j]=x.useState(""),[h,k]=x.useState(""),[g,D]=x.useState(!1),[y,U]=x.useState(!1);x.useEffect(()=>{if(c!=="custom"){const e=R(c);j(e.dateFrom),k(e.dateTo)}},[c]);const I=async()=>{try{D(!0);let e="",o=b,l=h;if(c==="custom")e=T(b,h);else{const n=R(c);o=n.dateFrom,l=n.dateTo,e=T(n.dateFrom,n.dateTo)}switch(v){case"total-skus":return await M(e);case"in-out-inventory":return await P(e,o,l);case"dead-inventory":return await E(e);case"most-selling":return await K(e);case"rejected-item":return await O(e,o,l);default:return null}}catch(e){return console.error("Error generating report:",e),alert("Error generating report. Please try again."),null}finally{D(!1)}},M=async e=>{const l=(await w.getAll({limit:1e4})).data||[],n=["SKU ID","Item Name","Brand","Category","Current Stock","Min Stock","Available Stock","Unit Price","Total Value"],d=l.map(s=>[s.skuId||"-",s.itemName||"-",s.brand||"-",s.productCategory||"-",p(s.currentStock||0),p(s.minStock||0),p(s.usefulStocks||(s.currentStock||0)-(s.bookStocks||0)),m(s.unitPrice||0),m((s.currentStock||0)*(s.unitPrice||0))]);return{headers:n,rows:d,title:"Total SKUs Report",dateRange:e}},P=async(e,o,l)=>{const[n,d]=await Promise.all([N.getIncomingHistory({dateFrom:o,dateTo:l}),N.getOutgoingHistory({dateFrom:o,dateTo:l})]),s=n.data||[],a=d.data||[],i=["Type","Invoice Number","Date","Vendor","Brand","Total Items","Total Value","Status"],f=[];return s.forEach(r=>{f.push(["INCOMING",r.invoiceNumber||"-",u(r.invoiceDate||r.receivingDate),r.vendorName||"-",r.brandName||"-",p(r.totalItems||0),m(r.totalValue||0),r.status||"-"])}),a.forEach(r=>{f.push(["OUTGOING",r.invoiceNumber||r.docketNumber||"-",u(r.date),r.destination||"-","-",p(r.totalItems||0),m(r.totalValue||0),r.status||"-"])}),{headers:i,rows:f,title:"IN/OUT Inventory Report",dateRange:e}},E=async e=>{const o=c==="custom"?6:c,n=(await w.getNonMovable({period:o})).data||[],d=["SKU ID","Item Name","Brand","Category","Current Stock","Unit Price","Inventory Value","Last Sale Date","Aging (Days)"],s=n.map(a=>[a.skuId||"-",a.itemName||"-",a.brand||"-",a.category||"-",p(a.currentStock||0),m(a.unitPrice||0),m(a.inventoryValue||0),a.lastSaleDate?u(a.lastSaleDate):"Never",p(a.aging||0)]);return{headers:d,rows:s,title:"Dead Inventory (Non-Movable SKUs) Report",dateRange:e}},K=async e=>{const o=c==="custom"?30:c*30,n=(await w.getMostSelling({period:o,sortBy:"units"})).data||[],d=["Rank","SKU ID","Item Name","Category","Units Sold","Revenue","Last Sale Date"],s=n.map((a,i)=>[i+1,a.skuId||"-",a.itemName||"-",a.category||"-",p(a.unitsSold||0),m(a.revenue||0),a.lastSaleDate?u(a.lastSaleDate):"-"]);return{headers:d,rows:s,title:"Most Selling SKUs Report",dateRange:e}},O=async(e,o,l)=>{const d=(await N.getRejectedItemReports({dateFrom:o,dateTo:l})).data||[],s=["Report No.","Inspection Date","SKU ID","Item Name","Quantity","Status","Original Invoice"],a=d.map(i=>[i.reportNumber||"-",u(i.inspectionDate),i.skuCode||`SKU-${i.skuId}`,i.itemName||"-",p(i.quantity||0),i.status||"Pending",i.originalInvoiceNumber||"-"]);return{headers:s,rows:a,title:"Rejected Item Report",dateRange:e}},V=async()=>{const e=await I();e&&await H(e)},G=async()=>{const e=await I();e&&await $(e)},L=[{id:"total-skus",label:"Total SKUs"},{id:"in-out-inventory",label:"IN/OUT Inventory"},{id:"dead-inventory",label:"Dead Inventory"},{id:"most-selling",label:"Most Selling SKUs"},{id:"rejected-item",label:"Rejected Item"}];return t.jsxs("div",{className:"p-6 space-y-[30px] w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-[18px]",children:t.jsxs("div",{className:"space-y-[6px]",children:[t.jsx("h1",{className:"text-[27px] font-black text-slate-900 tracking-tight",children:"Reports"}),t.jsx("p",{className:"text-[13.5px] text-slate-500 font-medium",children:"Generate and download reports in PDF or Excel format"})]})}),t.jsxs("div",{className:"bg-white rounded-[1.875rem] border border-slate-100 shadow-sm p-[18px]",children:[t.jsx("h2",{className:"text-[15px] font-black text-slate-900 uppercase tracking-wider mb-3",children:"Select Report Type"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-[9px]",children:L.map(e=>t.jsx("button",{onClick:()=>F(e.id),className:`px-3 py-[9px] rounded-xl font-black text-[9.75px] uppercase tracking-wider transition-all ${v===e.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"bg-slate-50 text-slate-700 border border-slate-200 hover:bg-slate-100"}`,children:e.label},e.id))})]}),t.jsxs("div",{className:"bg-white rounded-[1.875rem] border border-slate-100 shadow-sm p-[18px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h2",{className:"text-[15px] font-black text-slate-900 uppercase tracking-wider flex items-center gap-[6px]",children:[t.jsx(A,{className:"w-[15px] h-[15px]"}),"Date Range"]}),t.jsxs("button",{onClick:()=>U(!y),className:"text-[9.75px] font-black text-indigo-600 uppercase tracking-wider hover:text-indigo-700 flex items-center gap-[6px] px-3 py-[6px] rounded-xl hover:bg-indigo-50 transition-all",children:[t.jsx(q,{className:"w-3 h-3"}),y?"Hide":"Show"," Custom Dates"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-[9px] mb-3",children:[[1,3,6,12].map(e=>t.jsxs("button",{onClick:()=>S(e),className:`px-[15px] py-[7.5px] rounded-xl font-black text-[9.75px] uppercase tracking-wider transition-all ${c===e?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"bg-slate-50 text-slate-700 border border-slate-200 hover:bg-slate-100"}`,children:[e," Month",e>1?"s":""]},e)),t.jsx("button",{onClick:()=>S("custom"),className:`px-[15px] py-[7.5px] rounded-xl font-black text-[9.75px] uppercase tracking-wider transition-all ${c==="custom"?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"bg-slate-50 text-slate-700 border border-slate-200 hover:bg-slate-100"}`,children:"Custom"})]}),y&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 p-[18px] bg-slate-50 rounded-xl",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-[10.5px] font-medium text-gray-700 mb-[3px]",children:"From Date"}),t.jsx("input",{type:"date",value:b,onChange:e=>j(e.target.value),className:"w-full px-[9px] py-[6px] border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-[10.5px]"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-[10.5px] font-medium text-gray-700 mb-[3px]",children:"To Date"}),t.jsx("input",{type:"date",value:h,onChange:e=>k(e.target.value),className:"w-full px-[9px] py-[6px] border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-[10.5px]"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-[1.875rem] border border-slate-100 shadow-sm p-[18px]",children:[t.jsx("h2",{className:"text-[15px] font-black text-slate-900 uppercase tracking-wider mb-3",children:"Export Options"}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsxs("button",{onClick:V,disabled:g,className:"flex items-center gap-[6px] px-[18px] py-[9px] bg-rose-600 text-white rounded-xl hover:bg-rose-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-[9.75px] font-black uppercase tracking-wider shadow-sm",children:[t.jsx(B,{className:"w-[15px] h-[15px]"}),g?"Generating...":"Download PDF"]}),t.jsxs("button",{onClick:G,disabled:g,className:"flex items-center gap-[6px] px-[18px] py-[9px] bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-[9.75px] font-black uppercase tracking-wider shadow-sm",children:[t.jsx(z,{className:"w-[15px] h-[15px]"}),g?"Generating...":"Download Excel"]})]}),g&&t.jsxs("div",{className:"mt-3 flex items-center gap-[6px] text-slate-600",children:[t.jsx("div",{className:"w-3 h-3 border-2 border-indigo-600 border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-[10.5px] font-medium",children:"Loading report data..."})]})]})]})};export{ae as default};
