import{c as _e,r as d,j as e,u as Oe,R as Je}from"./index-C4O2RVGC.js";import{l as j}from"./libraryService-BC59J_DM.js";import{v as T,a as $e,b as Be,c as Re}from"./validators-CanHBN9q.js";import{utils as G,writeFile as me,read as et}from"./xlsx-D_0l8YDs.js";import{S as ue}from"./search-Cs94nLwN.js";import{P as se}from"./plus-DdeNo8e1.js";import{D as pe}from"./download-BnsO4lfA.js";import{P as ge}from"./pen-square-CYmGiHf-.js";import{T as he}from"./trash-2-BS2IYTwN.js";import{X as te}from"./x-ChutkFoY.js";import{a as Ge,f as tt}from"./formatters-ptPrPoGe.js";import{s as Ue}from"./skuService-CD47JNeC.js";import{B as st}from"./box-D0510-a0.js";import{P as at}from"./package-CBqWQTbk.js";import{B as rt}from"./building-2-CbjlN9o9.js";import{U as lt}from"./users-pUa6nTjK.js";import"./api-VNhYhLPD.js";import"./cachedApi-CKq13PPM.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=_e("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=_e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=_e("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=_e("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),ct=({vendors:$,loading:W,onRefresh:A})=>{const[F,U]=d.useState(""),[Y,_]=d.useState(!1),[M,R]=d.useState(null),[V,v]=d.useState(!1),[n,k]=d.useState({}),E=d.useRef(null),[i,I]=d.useState([]),[c,y]=d.useState([]),[N,D]=d.useState([]),[S,H]=d.useState([]),[L,b]=d.useState(0),[r,u]=d.useState([{name:""}]),[l,h]=d.useState(!1),[s,p]=d.useState(!1),[a,x]=d.useState({name:"",contactPerson:"",designation:"",phone:"",whatsappNumber:"",email:"",gstNumber:"",address:"",city:"",state:"",pin:"",isActive:!0,productCategoryIds:[],itemCategoryIds:[],subCategoryIds:[],brandIds:[]});d.useEffect(()=>{Y&&(j.getYourProductCategories().then(t=>{I(t.data||[])}),j.getYourBrands().then(t=>{H(t.data||[])}))},[Y]),d.useEffect(()=>{Y&&L>0?j.getYourItemCategories(L).then(t=>{y(t.data||[])}):(y([]),D([]),x({...a,itemCategoryIds:[],subCategoryIds:[]}))},[L,Y]),d.useEffect(()=>{if(Y&&a.itemCategoryIds&&a.itemCategoryIds.length>0){const t=a.itemCategoryIds.map(g=>j.getYourSubCategories(g));Promise.all(t).then(g=>{const K=g.flatMap(J=>J.data||[]).filter((J,we,Ce)=>we===Ce.findIndex(ie=>ie.id===J.id));D(K)})}else D([]),x({...a,subCategoryIds:[]})},[a.itemCategoryIds,Y]);const q=t=>{if(t){R(t);const g=t.productCategoryIds&&t.productCategoryIds.length>0?t.productCategoryIds[0]:0;b(g);const C=t.whatsappNumber===t.phone;p(C),x({...t,productCategoryIds:t.productCategoryIds||[],itemCategoryIds:t.itemCategoryIds||[],subCategoryIds:t.subCategoryIds||[],brandIds:t.brandIds||[]})}else R(null),b(0),p(!1),x({name:"",contactPerson:"",designation:"",phone:"",whatsappNumber:"",email:"",gstNumber:"",address:"",city:"",state:"",pin:"",isActive:!0,productCategoryIds:[],itemCategoryIds:[],subCategoryIds:[],brandIds:[]});y([]),D([]),u([{name:""}]),_(!0),k({})},B=t=>{const g=a.itemCategoryIds||[];g.includes(t)?x({...a,itemCategoryIds:g.filter(C=>C!==t)}):x({...a,itemCategoryIds:[...g,t]})},ee=t=>{const g=a.subCategoryIds||[];g.includes(t)?x({...a,subCategoryIds:g.filter(C=>C!==t)}):x({...a,subCategoryIds:[...g,t]})},re=t=>{const g=a.brandIds||[];g.includes(t)?x({...a,brandIds:g.filter(C=>C!==t)}):x({...a,brandIds:[...g,t]})},ye=()=>{u([...r,{name:""}])},fe=t=>{r.length>1&&u(r.filter((g,C)=>C!==t))},Ne=(t,g)=>{const C=[...r];C[t]={name:g},u(C)},le=async()=>{var g,C;const t=r.filter(K=>K.name.trim()!=="");if(t.length===0){alert("Please add at least one brand");return}try{v(!0);const K=t.map(ie=>j.createYourBrand({name:ie.name.trim(),description:"",isActive:!0})),we=(await Promise.all(K)).map(ie=>ie.data.id);x({...a,brandIds:[...a.brandIds||[],...we]});const Ce=await j.getYourBrands();H(Ce.data||[]),u([{name:""}]),h(!1)}catch(K){alert(((C=(g=K.response)==null?void 0:g.data)==null?void 0:C.error)||"Failed to save brands")}finally{v(!1)}},je=async()=>{var g,C;const t={};if(T(a.name||"")||(t.name="Vendor Name is required"),T(a.contactPerson||"")||(t.contactPerson="Contact Person is required"),T(a.designation||"")||(t.designation="Designation is required"),T(a.phone||"")?$e(a.phone||"")||(t.phone="Invalid phone number (10 digits)"):t.phone="Phone Number is required",T(a.email||"")?Be(a.email||"")||(t.email="Invalid email format"):t.email="Email is required",T(a.gstNumber||"")?Re(a.gstNumber||"")||(t.gstNumber="Invalid GST number format"):t.gstNumber="GST Number is required",T(a.pin||"")||(t.pin="Pincode is required"),T(a.city||"")||(t.city="City is required"),T(a.state||"")||(t.state="State is required"),T(a.address||"")||(t.address="Address is required"),(!L||L===0)&&(t.productCategory="Product Category is required"),(!a.brandIds||a.brandIds.length===0)&&(t.brands="At least one Brand is required"),Object.keys(t).length>0){k(t);return}try{v(!0),M?await j.updateYourVendor(M.id,a):await j.createYourVendor(a),_(!1),A()}catch(K){alert(((C=(g=K.response)==null?void 0:g.data)==null?void 0:C.error)||"Failed to save vendor")}finally{v(!1)}},ne=async t=>{var g,C;if(window.confirm("Are you sure you want to delete this vendor?"))try{v(!0),await j.deleteYourVendor(t),A()}catch(K){alert(((C=(g=K.response)==null?void 0:g.data)==null?void 0:C.error)||"Failed to delete vendor")}finally{v(!1)}},ve=()=>{const t=[{Name:"","Contact Person":"",Designation:"",Phone:"",Email:"","GST Number":"",Address:"",City:"",State:"",PIN:"","Is Active":"true"}],g=G.book_new(),C=G.json_to_sheet(t);C["!cols"]=[{wch:25},{wch:20},{wch:18},{wch:15},{wch:25},{wch:18},{wch:30},{wch:15},{wch:15},{wch:10},{wch:12}],G.book_append_sheet(g,C,"Vendors Template"),me(g,"Vendor_Upload_Template.xlsx")},Fe=()=>{var t;(t=E.current)==null||t.click()},oe=async t=>{var C,K;if(!t)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(t.type)){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{v(!0);const J=await j.uploadVendors(t);J.success&&(alert(`${J.message}
Inserted: ${J.inserted}
Errors: ${J.errors}`),A())}catch(J){alert(((K=(C=J.response)==null?void 0:C.data)==null?void 0:K.error)||"Failed to upload file")}finally{v(!1),E.current&&(E.current.value="")}},Me=$.filter(t=>{var g,C,K;return t.name.toLowerCase().includes(F.toLowerCase())||((g=t.contactPerson)==null?void 0:g.toLowerCase().includes(F.toLowerCase()))||((C=t.designation)==null?void 0:C.toLowerCase().includes(F.toLowerCase()))||((K=t.email)==null?void 0:K.toLowerCase().includes(F.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("div",{className:"flex-1 w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",value:F,onChange:t=>U(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>q(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Add Vendor"]}),e.jsxs("button",{onClick:ve,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",title:"Download Excel template with required columns",children:[e.jsx(pe,{className:"w-5 h-5"}),"Download Template"]}),e.jsxs("button",{onClick:Fe,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"Upload Excel"]}),e.jsx("input",{type:"file",ref:E,onChange:t=>{var g;return oe(((g=t.target.files)==null?void 0:g[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),W?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Vendor Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Contact Person"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Designation"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"GST Number"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Me.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"No vendors found"})}):Me.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.contactPerson||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.designation||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.phone||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.email||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.gstNumber||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:t.address||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>q(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ne(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},t.id))})]})})})]}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:M?"Edit Vendor":"Add Vendor"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.name,onChange:t=>x({...a,name:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.name?"border-red-500":"border-gray-300"}`}),n.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Person ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.contactPerson,onChange:t=>x({...a,contactPerson:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.contactPerson?"border-red-500":"border-gray-300"}`}),n.contactPerson&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.contactPerson})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Designation ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.designation,onChange:t=>x({...a,designation:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.designation?"border-red-500":"border-gray-300"}`}),n.designation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.designation})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.phone,onChange:t=>{const g=t.target.value;x({...a,phone:g,whatsappNumber:s?g:a.whatsappNumber})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.phone?"border-red-500":"border-gray-300"}`}),n.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Number"}),e.jsx("input",{type:"text",value:a.whatsappNumber||"",onChange:t=>{s||x({...a,whatsappNumber:t.target.value})},disabled:s,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${s?"bg-gray-100 cursor-not-allowed":""} ${n.whatsappNumber?"border-red-500":"border-gray-300"}`}),e.jsxs("label",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:t=>{const g=t.target.checked;p(g),x({...a,whatsappNumber:g?a.phone:""})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Same as Phone Number"})]}),n.whatsappNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.whatsappNumber})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:a.email,onChange:t=>x({...a,email:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.email?"border-red-500":"border-gray-300"}`}),n.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["GST Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.gstNumber,onChange:t=>x({...a,gstNumber:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.gstNumber?"border-red-500":"border-gray-300"}`}),n.gstNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.gstNumber})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Pincode ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.pin,onChange:t=>x({...a,pin:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.pin?"border-red-500":"border-gray-300"}`}),n.pin&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.pin})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.city,onChange:t=>x({...a,city:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.city?"border-red-500":"border-gray-300"}`}),n.city&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.city})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["State ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.state,onChange:t=>x({...a,state:t.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.state?"border-red-500":"border-gray-300"}`}),n.state&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.state})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:a.address,onChange:t=>x({...a,address:t.target.value}),rows:3,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.address?"border-red-500":"border-gray-300"}`}),n.address&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.address})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Product Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:L,onChange:t=>{const g=parseInt(t.target.value);b(g),x({...a,productCategoryIds:g>0?[g]:[],itemCategoryIds:[],subCategoryIds:[]})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.productCategory?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"0",children:"Select Product Category"}),i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),n.productCategory&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.productCategory})]}),L>0&&c.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Categories (Select Multiple)"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-2",children:c.map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:(a.itemCategoryIds||[]).includes(t.id),onChange:()=>B(t.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t.name})]},t.id))})]}),a.itemCategoryIds&&a.itemCategoryIds.length>0&&N.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sub Categories (Select Multiple)"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-2",children:N.map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:(a.subCategoryIds||[]).includes(t.id),onChange:()=>ee(t.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t.name})]},t.id))})]}),a.productCategoryIds&&a.productCategoryIds.length>0||a.itemCategoryIds&&a.itemCategoryIds.length>0||a.subCategoryIds&&a.subCategoryIds.length>0?e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Items"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2 max-h-48 overflow-y-auto",children:[a.productCategoryIds&&a.productCategoryIds.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Product Categories:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.productCategoryIds.map(t=>{const g=i.find(C=>C.id===t);return g?e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:g.name},t):null})})]}),a.itemCategoryIds&&a.itemCategoryIds.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Item Categories:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.itemCategoryIds.map(t=>{const g=c.find(C=>C.id===t);return g?e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:g.name},t):null})})]}),a.subCategoryIds&&a.subCategoryIds.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Sub Categories:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.subCategoryIds.map(t=>{const g=N.find(C=>C.id===t);return g?e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:g.name},t):null})})]})]})]}):null,e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Brands ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("button",{type:"button",onClick:()=>h(!0),className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),"Add Multiple Brands"]})]}),e.jsx("div",{className:`max-h-40 overflow-y-auto border rounded-lg p-2 space-y-2 ${n.brands?"border-red-500":"border-gray-300"}`,children:S.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No brands available"}):S.map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:(a.brandIds||[]).includes(t.id),onChange:()=>re(t.id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:t.name})]},t.id))}),n.brands&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.brands})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:a.isActive===!0,onChange:()=>x({...a,isActive:!0}),className:"text-blue-600"}),e.jsx("span",{children:"Active"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:a.isActive===!1,onChange:()=>x({...a,isActive:!1}),className:"text-blue-600"}),e.jsx("span",{children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:je,disabled:V,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":"Save"})]})]})})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add Multiple Brands"}),e.jsx("button",{onClick:()=>{h(!1),u([{name:""}])},className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Brand Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("button",{type:"button",onClick:ye,className:"text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),"Add Another"]})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2",children:r.map((t,g)=>e.jsxs("div",{className:"flex gap-2 items-center p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:t.name,onChange:C=>Ne(g,C.target.value),placeholder:`Brand Name ${g+1}`,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white"})}),r.length>1&&e.jsx("button",{type:"button",onClick:()=>fe(g),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove",children:e.jsx(te,{className:"w-4 h-4"})})]},g))})]})}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx("button",{onClick:()=>{h(!1),u([{name:""}])},className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:le,disabled:V||r.filter(t=>t.name.trim()).length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":`Save ${r.filter(t=>t.name.trim()).length} Brand(s)`})]})]})})})]})},dt=({brands:$,loading:W,onRefresh:A})=>{const[F,U]=d.useState(""),[Y,_]=d.useState(!1),[M,R]=d.useState(null),[V,v]=d.useState(!1),[n,k]=d.useState({}),E=d.useRef(null),[i,I]=d.useState({name:"",description:"",isActive:!0}),c=b=>{b?(R(b),I(b)):(R(null),I({name:"",description:"",isActive:!0})),_(!0),k({})},y=async()=>{var r,u;const b={};if(T(i.name||"")||(b.name="Brand Name is required"),Object.keys(b).length>0){k(b);return}try{v(!0),M?await j.updateYourBrand(M.id,i):await j.createYourBrand(i),_(!1),A()}catch(l){alert(((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to save brand")}finally{v(!1)}},N=async b=>{var r,u;if(window.confirm("Are you sure you want to delete this brand?"))try{v(!0),await j.deleteYourBrand(b),A()}catch(l){alert(((u=(r=l.response)==null?void 0:r.data)==null?void 0:u.error)||"Failed to delete brand")}finally{v(!1)}},D=()=>{const b=[{Name:"",Description:"","Is Active":"true"}],r=G.book_new(),u=G.json_to_sheet(b);u["!cols"]=[{wch:25},{wch:40},{wch:12}],G.book_append_sheet(r,u,"Brands Template"),me(r,"Brand_Upload_Template.xlsx")},S=()=>{var b;(b=E.current)==null||b.click()},H=async b=>{var u,l,h,s,p,a;if(!b)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(b.type)){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{v(!0);const x=await j.uploadBrands(b);if(x.success){let q=`${x.message}
Inserted: ${x.inserted}
Errors: ${x.errors}`;x.errorDetails&&x.errorDetails.length>0&&(q+=`

Error Details:`,x.errorDetails.forEach(B=>{q+=`
Row ${B.row}: ${B.error}`})),alert(q),A()}else alert(x.message||"Failed to upload file")}catch(x){const q=((l=(u=x.response)==null?void 0:u.data)==null?void 0:l.error)||((s=(h=x.response)==null?void 0:h.data)==null?void 0:s.message)||"Failed to upload file",B=(a=(p=x.response)==null?void 0:p.data)==null?void 0:a.errorDetails;let ee=q;B&&Array.isArray(B)&&B.length>0&&(ee+=`

Error Details:
`+B.map(re=>`Row ${re.row}: ${re.error||re}`).join(`
`)),alert(ee)}finally{v(!1),E.current&&(E.current.value="")}},L=$.filter(b=>{var r;return b.name.toLowerCase().includes(F.toLowerCase())||((r=b.description)==null?void 0:r.toLowerCase().includes(F.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("div",{className:"flex-1 w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",value:F,onChange:b=>U(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>c(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Add Brand"]}),e.jsxs("button",{onClick:D,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",title:"Download Excel template with required columns",children:[e.jsx(pe,{className:"w-5 h-5"}),"Download Template"]}),e.jsxs("button",{onClick:S,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"Upload Excel"]}),e.jsx("input",{type:"file",ref:E,onChange:b=>{var r;return H(((r=b.target.files)==null?void 0:r[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),W?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Brand Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Created Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:L.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"No brands found"})}):L.map(b=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:b.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:b.description||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${b.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:b.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:b.createdAt?Ge(b.createdAt):"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>N(b.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},b.id))})]})})})]}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:M?"Edit Brand":"Add Brand"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Brand Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.name,onChange:b=>I({...i,name:b.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.name?"border-red-500":"border-gray-300"}`}),n.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:b=>I({...i,description:b.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:i.isActive===!0,onChange:()=>I({...i,isActive:!0}),className:"text-blue-600"}),e.jsx("span",{children:"Active"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:i.isActive===!1,onChange:()=>I({...i,isActive:!1}),className:"text-blue-600"}),e.jsx("span",{children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:y,disabled:V,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":"Save"})]})]})})})]})},xt=({productCategories:$,itemCategories:W,subCategories:A,loading:F,onRefresh:U})=>{var Ye;const Y=Oe(),[_,M]=d.useState(""),[R,V]=d.useState([]),[v,n]=d.useState(!1),[k,E]=d.useState(null),[i,I]=d.useState("product"),[c,y]=d.useState(!1),[N,D]=d.useState({}),[S,H]=d.useState(!1),L=d.useRef(null),[b,r]=d.useState(!1),[u,l]=d.useState(null),[h,s]=d.useState(!1),[p,a]=d.useState({name:""}),[x,q]=d.useState({name:"",productCategoryId:0}),[B,ee]=d.useState({name:"",itemCategoryId:0}),[re,ye]=d.useState([]),[fe,Ne]=d.useState([]),[le,je]=d.useState([{name:""}]),[ne,ve]=d.useState([{name:""}]);d.useEffect(()=>{const o=[];$.forEach(m=>{o.push({id:`product-${m.id}`,type:"product",productCategory:m.name,itemCategory:"-",subCategory:"-",createdAt:m.createdAt||"",productCategoryId:m.id})}),W.forEach(m=>{const f=$.find(P=>P.id===m.productCategoryId);o.push({id:`item-${m.id}`,type:"item",productCategory:(f==null?void 0:f.name)||"-",itemCategory:m.name,subCategory:"-",createdAt:m.createdAt||"",productCategoryId:m.productCategoryId,itemCategoryId:m.id})}),A.forEach(m=>{const f=W.find(Q=>Q.id===m.itemCategoryId),P=$.find(Q=>Q.id===(f==null?void 0:f.productCategoryId));o.push({id:`sub-${m.id}`,type:"sub",productCategory:(P==null?void 0:P.name)||"-",itemCategory:(f==null?void 0:f.name)||"-",subCategory:m.name,createdAt:m.createdAt||"",productCategoryId:P==null?void 0:P.id,itemCategoryId:m.itemCategoryId,subCategoryId:m.id})}),o.sort((m,f)=>{const P=new Date(m.createdAt).getTime();return new Date(f.createdAt).getTime()-P}),V(o)},[$,W,A]),d.useEffect(()=>{v&&(j.getYourProductCategories().then(o=>{ye(o.data||[])}),(i==="sub"||i==="item")&&j.getYourItemCategories().then(o=>{Ne(o.data||[])}))},[v,i]);const Fe=R.filter(o=>{const m=_.toLowerCase();return!!o.productCategory&&o.productCategory!=="-"&&!!o.itemCategory&&o.itemCategory!=="-"&&!!o.subCategory&&o.subCategory!=="-"?o.productCategory.toLowerCase().includes(m)||o.itemCategory.toLowerCase().includes(m)||o.subCategory.toLowerCase().includes(m):!1}),oe=()=>{n(!1),E(null),D({}),H(!1)},Me=()=>{je([...le,{name:""}])},t=(o,m)=>{const f=[...le];f[o]={name:m},je(f)},g=o=>{le.length>1&&je(le.filter((m,f)=>f!==o))},C=()=>{ve([...ne,{name:""}])},K=(o,m)=>{const f=[...ne];f[o]={name:m},ve(f)},J=o=>{ne.length>1&&ve(ne.filter((m,f)=>f!==o))},we=async()=>{var m,f;const o=le.filter(P=>P.name.trim()!=="");if(o.length===0){D({name:"Please add at least one item category"});return}if(!x.productCategoryId||x.productCategoryId===0){D({productCategoryId:"Product Category is required"});return}try{y(!0);const P=o.map(Q=>j.createYourItemCategory({name:Q.name.trim(),productCategoryId:x.productCategoryId}));await Promise.all(P),oe(),U()}catch(P){alert(((f=(m=P.response)==null?void 0:m.data)==null?void 0:f.error)||"Failed to save item categories")}finally{y(!1)}},Ce=async()=>{var m,f;const o=ne.filter(P=>P.name.trim()!=="");if(o.length===0){D({name:"Please add at least one sub category"});return}if(!B.itemCategoryId||B.itemCategoryId===0){D({itemCategoryId:"Item Category is required"});return}try{y(!0);const P=o.map(Q=>j.createYourSubCategory({name:Q.name.trim(),itemCategoryId:B.itemCategoryId}));await Promise.all(P),oe(),U()}catch(P){alert(((f=(m=P.response)==null?void 0:m.data)==null?void 0:f.error)||"Failed to save sub categories")}finally{y(!1)}},ie=async()=>{var m,f;if(S&&i==="item"){await we();return}if(S&&i==="sub"){await Ce();return}const o={};if(i==="product"?T(p.name)||(o.name="Category Name is required"):i==="item"?(T(x.name)||(o.name="Category Name is required"),(!x.productCategoryId||x.productCategoryId===0)&&(o.productCategoryId="Product Category is required")):i==="sub"&&(T(B.name)||(o.name="Category Name is required"),(!B.itemCategoryId||B.itemCategoryId===0)&&(o.itemCategoryId="Item Category is required")),Object.keys(o).length>0){D(o);return}try{y(!0),k?i==="product"&&k.productCategoryId?await j.updateYourProductCategory(k.productCategoryId,p):i==="item"&&k.itemCategoryId?await j.updateYourItemCategory(k.itemCategoryId,x):i==="sub"&&k.subCategoryId&&await j.updateYourSubCategory(k.subCategoryId,B):i==="product"?await j.createYourProductCategory(p):i==="item"?await j.createYourItemCategory(x):i==="sub"&&await j.createYourSubCategory(B),oe(),U()}catch(P){alert(((f=(m=P.response)==null?void 0:m.data)==null?void 0:f.error)||`Failed to save ${i} category`)}finally{y(!1)}},ze=async o=>{var f,P;const m=o.type==="product"?"product category":o.type==="item"?"item category":"sub category";if(window.confirm(`Are you sure you want to delete this ${m}?`))try{y(!0),o.type==="product"&&o.productCategoryId?await j.deleteYourProductCategory(o.productCategoryId):o.type==="item"&&o.itemCategoryId?await j.deleteYourItemCategory(o.itemCategoryId):o.type==="sub"&&o.subCategoryId&&await j.deleteYourSubCategory(o.subCategoryId),U()}catch(Q){alert(((P=(f=Q.response)==null?void 0:f.data)==null?void 0:P.error)||`Failed to delete ${m}`)}finally{y(!1)}},Ke=()=>{const o=G.book_new(),m=[["Category Master Template","",""],["Product Category","Item Category","Sub Category"],["","",""]],f=G.aoa_to_sheet(m);f["!cols"]=[{wch:25},{wch:25},{wch:25}],f["!merges"]=[{s:{r:0,c:0},e:{r:0,c:2}}],G.book_append_sheet(o,f,"Category Master"),me(o,"Category_Master_Upload_Template.xlsx")},We=()=>{var o;(o=L.current)==null||o.click()},Qe=o=>new Promise((m,f)=>{const P=new FileReader;P.onload=Q=>{var ce;try{const ae=new Uint8Array((ce=Q.target)==null?void 0:ce.result),Se=et(ae,{type:"array"}),ke=Se.SheetNames.find(w=>{const O=w.toLowerCase().trim();return O.includes("category")&&O.includes("master")||O==="category master"||O==="categorymaster"});if(!ke){f(new Error("Category Master sheet not found in the file"));return}const Ie=Se.Sheets[ke];let Pe=2;const Le=5;for(let w=0;w<Le;w++){const O=Ie[G.encode_cell({r:w,c:0})];if(O&&O.v&&O.v.toString().toLowerCase().includes("product category")){Pe=w+1;break}}const Ae=G.sheet_to_json(Ie,{header:["Product Category","Item Category","Sub Category"],range:Pe,defval:null,blankrows:!1}).filter(w=>w["Product Category"]&&w["Product Category"].toString().trim()||w["Item Category"]&&w["Item Category"].toString().trim()||w["Sub Category"]&&w["Sub Category"].toString().trim()),De=new Map,de=new Map,xe=new Map;for(const w of Ae){const O=(w["Product Category"]||"").toString().trim(),z=(w["Item Category"]||"").toString().trim(),X=(w["Sub Category"]||"").toString().trim();if(O){const Z=O.toLowerCase().trim();De.has(Z)||De.set(Z,O.trim())}if(O&&z){const Z=O.toLowerCase().trim();de.has(Z)||de.set(Z,new Map);const Ee=z.toLowerCase().trim();de.get(Z).has(Ee)||de.get(Z).set(Ee,z.trim())}if(O&&z&&X){const Z=`${O.toLowerCase().trim()}|${z.toLowerCase().trim()}`;xe.has(Z)||xe.set(Z,new Map);const Ee=X.toLowerCase().trim();xe.get(Z).has(Ee)||xe.get(Z).set(Ee,X.trim())}}const Te=[];for(const w of Ae){const O=(w["Product Category"]||"").toString().trim(),z=(w["Item Category"]||"").toString().trim(),X=(w["Sub Category"]||"").toString().trim();Te.push({productCategory:O||"",itemCategory:z||"",subCategory:X||""})}m({rows:Te})}catch(ae){f(ae)}},P.onerror=()=>f(new Error("Failed to read file")),P.readAsArrayBuffer(o)}),Ze=async o=>{if(!o)return;const m=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/octet-stream","application/x-zip-compressed","text/csv"],f=[".xlsx",".xls",".csv"],P=o.name.toLowerCase().substring(o.name.lastIndexOf(".")),Q=m.includes(o.type),ce=f.includes(P);if(!Q&&!ce){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{y(!0);const ae=await Qe(o);l({...ae,file:o}),r(!0)}catch(ae){alert(ae.message||"Failed to parse Excel file")}finally{y(!1)}},Xe=async()=>{var o,m,f,P,Q,ce,ae,Se,ke,Ie,Pe,Le,qe,Ae,De,de,xe,Te;if(u!=null&&u.file)try{s(!0);const w=await j.uploadCategories(u.file);if(w.success){let O=`Upload Summary:

Product Categories: ${((o=w.productCategories)==null?void 0:o.inserted)||0} inserted, ${((m=w.productCategories)==null?void 0:m.updated)||0} already existed, ${((f=w.productCategories)==null?void 0:f.errors)||0} errors
Item Categories: ${((P=w.itemCategories)==null?void 0:P.inserted)||0} inserted, ${((Q=w.itemCategories)==null?void 0:Q.updated)||0} already existed, ${((ce=w.itemCategories)==null?void 0:ce.errors)||0} errors
Sub Categories: ${((ae=w.subCategories)==null?void 0:ae.inserted)||0} inserted, ${((Se=w.subCategories)==null?void 0:Se.updated)||0} already existed, ${((ke=w.subCategories)==null?void 0:ke.errors)||0} errors`;const z=[];(Ie=w.productCategories)!=null&&Ie.errorDetails&&w.productCategories.errorDetails.length>0&&(z.push(`
Product Category Errors:`),w.productCategories.errorDetails.forEach(X=>{z.push(`  - ${X.error}`)})),(Pe=w.itemCategories)!=null&&Pe.errorDetails&&w.itemCategories.errorDetails.length>0&&(z.push(`
Item Category Errors:`),w.itemCategories.errorDetails.forEach(X=>{z.push(`  - ${X.error}`)})),(Le=w.subCategories)!=null&&Le.errorDetails&&w.subCategories.errorDetails.length>0&&(z.push(`
Sub Category Errors:`),w.subCategories.errorDetails.forEach(X=>{z.push(`  - ${X.error}`)})),z.length>0&&(O+=`

`+z.join(`
`)),r(!1),l(null),alert(O),U()}else alert(w.message||"Failed to upload file")}catch(w){const O=((Ae=(qe=w.response)==null?void 0:qe.data)==null?void 0:Ae.error)||((de=(De=w.response)==null?void 0:De.data)==null?void 0:de.message)||"Failed to upload file",z=(Te=(xe=w.response)==null?void 0:xe.data)==null?void 0:Te.errorDetails;let X=O;z&&Array.isArray(z)&&z.length>0&&(X+=`

Error Details:
`+z.map(Z=>`  - ${Z.error||Z}`).join(`
`)),alert(X)}finally{s(!1),L.current&&(L.current.value="")}},Ve=()=>{r(!1),l(null),L.current&&(L.current.value="")};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search categories...",value:_,onChange:o=>M(o.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>Y("/app/library/categories/manage"),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 text-sm",children:[e.jsx(se,{className:"w-4 h-4"}),"Add Product"]}),e.jsxs("button",{onClick:Ke,className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2 text-sm",title:"Download unified Excel template with all category types",children:[e.jsx(pe,{className:"w-4 h-4"}),"Download Template"]}),e.jsxs("button",{onClick:We,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 text-sm",children:[e.jsx(be,{className:"w-4 h-4"}),"Upload Excel"]}),e.jsx("input",{type:"file",ref:L,onChange:o=>{var m;return Ze(((m=o.target.files)==null?void 0:m[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),F?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-6 h-6 border-3 border-blue-600 border-t-transparent rounded-full animate-spin"})}):Fe.length===0?e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:"text-gray-600 text-sm",children:"No categories found"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 uppercase",children:"Product Category"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 uppercase",children:"Item Category"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 uppercase",children:"Sub Category"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 uppercase",children:"Created Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Fe.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-center",children:o.productCategory}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-center",children:o.itemCategory}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-900 text-center",children:o.subCategory}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-500 text-center",children:o.createdAt?Ge(o.createdAt):"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>Y("/app/library/categories/manage",{state:{fromCategoryMaster:!0,type:o.type,productCategoryId:o.productCategoryId,itemCategoryId:o.itemCategoryId,subCategoryId:o.subCategoryId}}),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(ge,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>ze(o),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(he,{className:"w-3.5 h-3.5"})})]})})]},o.id))})]})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:`bg-white rounded-lg shadow-xl w-full mx-4 max-h-[90vh] overflow-y-auto ${S&&(i==="item"||i==="sub")?"max-w-3xl":"max-w-2xl"}`,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:k?`Edit ${i==="product"?"Product":i==="item"?"Item":"Sub"} Category`:`Add ${i==="product"?"Product":i==="item"?"Item":"Sub"} Category`}),e.jsx("button",{onClick:oe,className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-5 h-5"})})]}),(i==="item"||i==="sub")&&!k&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg border border-gray-200 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-900",children:"Entry Mode"}),e.jsx("span",{className:"text-[10px] text-gray-500 mt-0.5",children:S?"Add multiple categories at once":"Add one category at a time"})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("span",{className:`text-xs font-medium transition-colors ${S?"text-gray-500":"text-gray-900"}`,children:"Single"}),e.jsx("button",{type:"button",onClick:()=>{H(!S),D({})},className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 ${S?"bg-blue-600":"bg-gray-300"}`,role:"switch","aria-checked":S,children:e.jsx("span",{className:`inline-block h-3.5 w-3.5 transform rounded-full bg-white transition-transform ${S?"translate-x-5":"translate-x-0.5"}`})}),e.jsx("span",{className:`text-xs font-medium transition-colors ${S?"text-gray-900":"text-gray-500"}`,children:"Multiple"})]})]}),e.jsxs("div",{className:"space-y-4",children:[i==="product"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Product Category Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:p.name,onChange:o=>a({name:o.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 text-sm ${N.name?"border-red-500":"border-gray-300"}`}),N.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.name})]}),i==="item"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Product Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:x.productCategoryId,onChange:o=>q({...x,productCategoryId:parseInt(o.target.value)}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm ${N.productCategoryId?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"0",children:"Select Product Category"}),re.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]}),N.productCategoryId&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.productCategoryId})]}),S&&!k?e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Item Category Names ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[le.map((o,m)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o.name,onChange:f=>t(m,f.target.value),placeholder:`Item Category ${m+1}`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"}),le.length>1&&e.jsx("button",{type:"button",onClick:()=>g(m),className:"px-2 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(te,{className:"w-4 h-4"})})]},m)),e.jsxs("button",{type:"button",onClick:Me,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(se,{className:"w-3.5 h-3.5"}),"Add Another"]})]}),N.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.name})]}):e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Item Category Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:x.name,onChange:o=>q({...x,name:o.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 text-sm ${N.name?"border-red-500":"border-gray-300"}`}),N.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.name})]})]}),i==="sub"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Item Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:B.itemCategoryId,onChange:o=>ee({...B,itemCategoryId:parseInt(o.target.value)}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm ${N.itemCategoryId?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"0",children:"Select Item Category"}),fe.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]}),N.itemCategoryId&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.itemCategoryId})]}),S&&!k?e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Sub Category Names ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[ne.map((o,m)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o.name,onChange:f=>K(m,f.target.value),placeholder:`Sub Category ${m+1}`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"}),ne.length>1&&e.jsx("button",{type:"button",onClick:()=>J(m),className:"px-2 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(te,{className:"w-4 h-4"})})]},m)),e.jsxs("button",{type:"button",onClick:C,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(se,{className:"w-3.5 h-3.5"}),"Add Another"]})]}),N.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.name})]}):e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Sub Category Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:B.name,onChange:o=>ee({...B,name:o.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 text-sm ${N.name?"border-red-500":"border-gray-300"}`}),N.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:N.name})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2.5 mt-4",children:[e.jsx("button",{onClick:oe,className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 text-sm",children:"Cancel"}),e.jsx("button",{onClick:ie,disabled:c,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:c?"Saving...":k?"Update":"Save"})]})]})})}),b&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full mx-4 max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Upload Preview"}),e.jsx("button",{onClick:Ve,className:"text-gray-400 hover:text-gray-600",disabled:h,children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"File:"})," ",(Ye=u.file)==null?void 0:Ye.name]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:'Review the categories below. Click "Save and Done" to upload them to the system.'})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:u.rows.length>0?e.jsx("div",{className:"overflow-x-auto max-h-[60vh] overflow-y-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Product Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Item Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Sub Category"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.rows.map((o,m)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:m+1}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.productCategory||"-"}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.itemCategory||"-"}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.subCategory||"-"})]},m))})]})}):e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No categories found"})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:Ve,disabled:h,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 text-sm font-medium",children:"Cancel"}),e.jsx("button",{onClick:Xe,disabled:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 text-sm font-medium flex items-center gap-2",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Uploading..."]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:"Save and Done"})})})]})]})})})]})},He={"Engineering / Technology":["Software Engineer","Engineering Manager"],Product:["Product Manager","Product Lead"],"Quality / Testing":["QA Engineer","QA Manager"],"Data / Analytics":["Data Analyst","Data Scientist"],Sales:["Sales Executive","Sales Manager"],Marketing:["Marketing Specialist","Marketing Manager"],"Customer Support / Success":["Customer Support Executive","Customer Success Manager"],"Finance / Accounts":["Accountant","Finance Manager"],"Human Resources (HR)":["HR Executive","HR Manager"],Operations:["Operations Executive","Operations Manager"],"Legal / Compliance":["Legal Officer","Compliance Manager"],Administration:["Admin Executive","Admin Manager"]},mt=Object.keys(He),ut=({teams:$,loading:W,onRefresh:A})=>{const[F,U]=d.useState(""),[Y,_]=d.useState(!1),[M,R]=d.useState(null),[V,v]=d.useState(!1),[n,k]=d.useState({}),E=d.useRef(null),[i,I]=d.useState({name:"",contactNumber:"",emailId:"",department:"",designation:"",isActive:!0}),c=s=>{s?(R(s),I({...s})):(R(null),I({name:"",contactNumber:"",emailId:"",department:"",designation:"",isActive:!0})),_(!0),k({})},y=s=>{I({...i,department:s,designation:""}),n.designation&&k(p=>({...p,designation:void 0}))},N=s=>{I({...i,designation:s}),n.designation&&k(p=>({...p,designation:void 0}))},D=s=>{let p=s.replace(/[^A-Za-z\s\-'\.]/g,"");p.length>25&&(p=p.substring(0,25)),I({...i,name:p}),n.name&&k(a=>({...a,name:void 0}))},S=s=>{let p=s.replace(/[^0-9]/g,"");p.length>10&&(p=p.substring(0,10)),I({...i,contactNumber:p}),n.contactNumber&&k(a=>({...a,contactNumber:void 0}))},H=i.department?He[i.department]||[]:[],L=async()=>{var p,a;const s={};if(T(i.name||"")||(s.name="Name is required"),T(i.contactNumber||"")?$e(i.contactNumber||"")||(s.contactNumber="Invalid phone number (10 digits)"):s.contactNumber="Contact Number is required",T(i.emailId||"")?Be(i.emailId||"")||(s.emailId="Invalid email format"):s.emailId="Email ID is required",T(i.department||"")||(s.department="Department is required"),T(i.designation||"")||(s.designation="Designation is required"),Object.keys(s).length>0){k(s);return}try{v(!0),M?await j.updateTeam(M.id,i):await j.createTeam(i),_(!1),A()}catch(x){alert(((a=(p=x.response)==null?void 0:p.data)==null?void 0:a.error)||"Failed to save team member")}finally{v(!1)}},b=async s=>{var p,a;if(window.confirm("Are you sure you want to delete this team member?"))try{v(!0),await j.deleteTeam(s),A()}catch(x){alert(((a=(p=x.response)==null?void 0:p.data)==null?void 0:a.error)||"Failed to delete team member")}finally{v(!1)}},r=()=>{const s=[{Name:"","Contact Number":"","Email ID":"",Department:"",Designation:"","Is Active":"true"}],p=G.book_new(),a=G.json_to_sheet(s);a["!cols"]=[{wch:25},{wch:18},{wch:25},{wch:20},{wch:20},{wch:12}],G.book_append_sheet(p,a,"Teams Template"),me(p,"Team_Upload_Template.xlsx")},u=()=>{var s;(s=E.current)==null||s.click()},l=async s=>{var a,x;if(!s)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(s.type)){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{v(!0);const q=await j.uploadTeams(s);q.success&&(alert(`${q.message}
Inserted: ${q.inserted}
Errors: ${q.errors}`),A())}catch(q){alert(((x=(a=q.response)==null?void 0:a.data)==null?void 0:x.error)||"Failed to upload file")}finally{v(!1),E.current&&(E.current.value="")}},h=$.filter(s=>{var p,a,x,q;return s.name.toLowerCase().includes(F.toLowerCase())||((p=s.contactNumber)==null?void 0:p.toLowerCase().includes(F.toLowerCase()))||((a=s.emailId)==null?void 0:a.toLowerCase().includes(F.toLowerCase()))||((x=s.department)==null?void 0:x.toLowerCase().includes(F.toLowerCase()))||((q=s.designation)==null?void 0:q.toLowerCase().includes(F.toLowerCase()))});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("div",{className:"flex-1 w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",value:F,onChange:s=>U(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>c(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Add Team"]}),e.jsxs("button",{onClick:r,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",title:"Download Excel template with required columns",children:[e.jsx(pe,{className:"w-5 h-5"}),"Download Template"]}),e.jsxs("button",{onClick:u,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"Upload Excel"]}),e.jsx("input",{type:"file",ref:E,onChange:s=>{var p;return l(((p=s.target.files)==null?void 0:p[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),W?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Contact Number"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Email ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Designation"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No team members found"})}):h.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:s.contactNumber||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:s.emailId||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:s.department||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:s.designation||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(s.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},s.id))})]})})})]}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:M?"Edit Team Member":"Add Team Member"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.name,onChange:s=>D(s.target.value),maxLength:25,pattern:"[A-Za-z\\s\\-'\\.]+",className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.name?"border-red-500":"border-gray-300"}`,placeholder:"Enter name",title:"Name should contain only letters, spaces, hyphens, and apostrophes (max 25 characters)"}),n.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.contactNumber,onChange:s=>S(s.target.value),maxLength:10,pattern:"[0-9]{10}",inputMode:"numeric",className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.contactNumber?"border-red-500":"border-gray-300"}`,placeholder:"Enter contact number",title:"Contact number should contain exactly 10 digits"}),n.contactNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.contactNumber})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:i.emailId,onChange:s=>I({...i,emailId:s.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.emailId?"border-red-500":"border-gray-300"}`,placeholder:"Enter email ID"}),n.emailId&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.emailId})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.department||"",onChange:s=>y(s.target.value),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.department?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select Department"}),mt.map(s=>e.jsx("option",{value:s,children:s},s))]}),n.department&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.department})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Designation ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.designation||"",onChange:s=>N(s.target.value),disabled:!i.department,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.designation?"border-red-500":"border-gray-300"} ${i.department?"":"bg-gray-100 cursor-not-allowed"}`,children:[e.jsx("option",{value:"",children:i.department?"Select Designation":"Select Department first"}),H.map(s=>e.jsx("option",{value:s,children:s},s))]}),n.designation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.designation})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:L,disabled:V,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":"Save"})]})]})})})]})},pt=({customers:$,loading:W,onRefresh:A})=>{const[F,U]=d.useState(""),[Y,_]=d.useState(!1),[M,R]=d.useState(null),[V,v]=d.useState(!1),[n,k]=d.useState({}),E=d.useRef(null),[i,I]=d.useState(!1),[c,y]=d.useState({name:"",contactPerson:"",phone:"",whatsappNumber:"",email:"",gstNumber:"",address:"",city:"",state:"",pin:"",isActive:!0}),N=$.filter(l=>{var s,p,a,x,q,B,ee;const h=F.toLowerCase();return((s=l.name)==null?void 0:s.toLowerCase().includes(h))||((p=l.contactPerson)==null?void 0:p.toLowerCase().includes(h))||((a=l.phone)==null?void 0:a.toLowerCase().includes(h))||((x=l.email)==null?void 0:x.toLowerCase().includes(h))||((q=l.gstNumber)==null?void 0:q.toLowerCase().includes(h))||((B=l.city)==null?void 0:B.toLowerCase().includes(h))||((ee=l.state)==null?void 0:ee.toLowerCase().includes(h))}),D=l=>{if(l){R(l);const h=l.whatsappNumber===l.phone;I(h),y({name:l.name||"",contactPerson:l.contactPerson||"",phone:l.phone||"",whatsappNumber:l.whatsappNumber||"",email:l.email||"",gstNumber:l.gstNumber||"",address:l.address||"",city:l.city||"",state:l.state||"",pin:l.pin||"",isActive:l.isActive!==!1})}else R(null),I(!1),y({name:"",contactPerson:"",phone:"",whatsappNumber:"",email:"",gstNumber:"",address:"",city:"",state:"",pin:"",isActive:!0});k({}),_(!0)},S=()=>{_(!1),R(null),k({})},H=async()=>{var h,s;const l={};if(T(c.name||"")||(l.name="Company Name is required"),T(c.contactPerson||"")||(l.contactPerson="Contact Person is required"),T(c.phone||"")?$e(c.phone||"")||(l.phone="Invalid phone number (10 digits)"):l.phone="Phone Number is required",T(c.whatsappNumber||"")?$e(c.whatsappNumber||"")||(l.whatsappNumber="Invalid WhatsApp number (10 digits)"):l.whatsappNumber="WhatsApp Number is required",T(c.email||"")?Be(c.email||"")||(l.email="Invalid email format"):l.email="Email is required",T(c.gstNumber||"")?Re(c.gstNumber||"")||(l.gstNumber="Invalid GST number format"):l.gstNumber="GST Number is required",T(c.pin||"")||(l.pin="PIN is required"),T(c.city||"")||(l.city="City is required"),T(c.state||"")||(l.state="State is required"),T(c.address||"")||(l.address="Address is required"),Object.keys(l).length>0){k(l);return}try{v(!0),M?await j.updateCustomer(M.id,c):await j.createCustomer(c),S(),A()}catch(p){alert(((s=(h=p.response)==null?void 0:h.data)==null?void 0:s.error)||"Failed to save customer")}finally{v(!1)}},L=async l=>{var h,s;if(window.confirm("Are you sure you want to delete this customer?"))try{v(!0),await j.deleteCustomer(l),A()}catch(p){alert(((s=(h=p.response)==null?void 0:h.data)==null?void 0:s.error)||"Failed to delete customer")}finally{v(!1)}},b=()=>{const l=[{Name:"","Contact Person":"",Phone:"",Email:"","GST Number":"",Address:"",City:"",State:"",PIN:"","Is Active":"true"}],h=G.book_new(),s=G.json_to_sheet(l);s["!cols"]=[{wch:25},{wch:20},{wch:15},{wch:25},{wch:18},{wch:30},{wch:15},{wch:15},{wch:10},{wch:12}],G.book_append_sheet(h,s,"Customers Template"),me(h,"Customer_Upload_Template.xlsx")},r=()=>{var l;(l=E.current)==null||l.click()},u=async l=>{var s,p;if(!l)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(l.type)){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{v(!0);const a=await j.uploadCustomers(l);a.success&&(alert(`${a.message}
Inserted: ${a.inserted}
Errors: ${a.errors}`),A())}catch(a){alert(((p=(s=a.response)==null?void 0:s.data)==null?void 0:p.error)||"Failed to upload file")}finally{v(!1),E.current&&(E.current.value="")}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search customers...",value:F,onChange:l=>U(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>D(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Add Customer"]}),e.jsxs("button",{onClick:b,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",title:"Download Excel template with required columns",children:[e.jsx(pe,{className:"w-5 h-5"}),"Download Template"]}),e.jsxs("button",{onClick:r,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"Upload Excel"]}),e.jsx("input",{type:"file",ref:E,onChange:l=>{var h;return u(((h=l.target.files)==null?void 0:h[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),W?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Company Name"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Contact Person"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Phone"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Email"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"GST Number"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"City"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"State"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-3 py-6 text-center text-gray-500 text-xs",children:"No customers found"})}):N.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-xs font-medium text-gray-900",children:l.name}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:l.contactPerson||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:l.phone||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:l.email||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:l.gstNumber||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:l.city||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:l.state||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${l.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:l.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-3 py-2 text-xs",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D(l),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>L(l.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},l.id))})]})})}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:M?"Edit Customer":"Add Customer"}),e.jsx("button",{onClick:S,className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.name,onChange:l=>y({...c,name:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.name?"border-red-500":"border-gray-300"}`}),n.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Person ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.contactPerson,onChange:l=>y({...c,contactPerson:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.contactPerson?"border-red-500":"border-gray-300"}`}),n.contactPerson&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.contactPerson})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.phone,onChange:l=>{const h=l.target.value;y({...c,phone:h,whatsappNumber:i?h:c.whatsappNumber})},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.phone?"border-red-500":"border-gray-300"}`}),n.phone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.phone})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["WhatsApp Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.whatsappNumber||"",onChange:l=>{i||y({...c,whatsappNumber:l.target.value})},disabled:i,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${i?"bg-gray-100 cursor-not-allowed":""} ${n.whatsappNumber?"border-red-500":"border-gray-300"}`}),e.jsxs("label",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:l=>{const h=l.target.checked;I(h),y({...c,whatsappNumber:h?c.phone:""})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Same as Phone Number"})]}),n.whatsappNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.whatsappNumber})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:c.email,onChange:l=>y({...c,email:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.email?"border-red-500":"border-gray-300"}`}),n.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["GST Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.gstNumber,onChange:l=>y({...c,gstNumber:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.gstNumber?"border-red-500":"border-gray-300"}`}),n.gstNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.gstNumber})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PIN ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.pin,onChange:l=>y({...c,pin:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.pin?"border-red-500":"border-gray-300"}`}),n.pin&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.pin})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.city,onChange:l=>y({...c,city:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.city?"border-red-500":"border-gray-300"}`}),n.city&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.city})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["State ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.state,onChange:l=>y({...c,state:l.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.state?"border-red-500":"border-gray-300"}`}),n.state&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.state})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:c.address,onChange:l=>y({...c,address:l.target.value}),rows:3,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.address?"border-red-500":"border-gray-300"}`}),n.address&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.address})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:c.isActive!==!1,onChange:l=>y({...c,isActive:l.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:S,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:H,disabled:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":M?"Update":"Save"})]})]})})})]})},gt=({products:$,loading:W,onRefresh:A})=>{const F=Oe(),[U,Y]=d.useState(""),[_,M]=d.useState(!1),[R,V]=d.useState(!1),v=d.useRef(null),n=async c=>{var y,N;if(window.confirm("Are you sure you want to delete this product?"))try{M(!0),await Ue.delete(c),A()}catch(D){alert(((N=(y=D.response)==null?void 0:y.data)==null?void 0:N.error)||"Failed to delete product")}finally{M(!1)}},k=()=>{var c;(c=v.current)==null||c.click()},E=()=>{const c=["Basic Information*","","","","","Vendor & Brand Information*","","","","Product Specifications*","","","","Inventory Settings*","","","Optional Specifications","","","","","","","","","","",""],y=["Product Category *","Item Category *","Sub Category *","Item Name *","Item Details as per Vendor","Vendor *","Vendor Item Code *","Brand *","HSN/SAC Code *","Rating/Size *","Model *","Series *","Unit *","Current Stock *","Minimum Stock Level","Default Storage Location *","Material","Insulation","Input Supply","Color","CRI","CCT","Beam Angle","LED Type","Shape","Weight (Kg)","Length (cm)","Width (cm)","Height (cm)"],N=G.book_new(),D=[c,y,y.map(()=>"")],S=G.aoa_to_sheet(D),H=[{wch:25},{wch:20},{wch:20},{wch:25},{wch:30},{wch:20},{wch:18},{wch:20},{wch:15},{wch:15},{wch:15},{wch:15},{wch:10},{wch:15},{wch:18},{wch:20},{wch:15},{wch:15},{wch:15},{wch:10},{wch:10},{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12}];S["!cols"]=H,S["!merges"]=[{s:{r:0,c:0},e:{r:0,c:4}},{s:{r:0,c:5},e:{r:0,c:8}},{s:{r:0,c:9},e:{r:0,c:12}},{s:{r:0,c:13},e:{r:0,c:15}},{s:{r:0,c:16},e:{r:0,c:28}}],G.book_append_sheet(N,S,"Products Template"),me(N,"Product_Upload_Template.xlsx")},i=async c=>{var N,D,S,H,L,b;if(!c)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(c.type)){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{V(!0);const r=await Ue.upload(c);if(r.success){let u=` Successfully uploaded ${r.inserted} product(s)`;if(r.errors>0&&(u+=`

 ${r.errors} error(s) occurred:`,r.errorDetails&&r.errorDetails.length>0)){const l=r.errorDetails.slice(0,10).map(h=>`Row ${h.row}: ${h.error}`).join(`
`);u+=`

`+l,r.errorDetails.length>10&&(u+=`

... and ${r.errorDetails.length-10} more error(s)`)}alert(u),A()}else alert(r.message||"Failed to upload products")}catch(r){console.error("Upload error:",r);let u="Failed to upload file";if((D=(N=r.response)==null?void 0:N.data)!=null&&D.error?u=r.response.data.error:(H=(S=r.response)==null?void 0:S.data)!=null&&H.message?u=r.response.data.message:r.message&&(u=r.message),(b=(L=r.response)==null?void 0:L.data)!=null&&b.errorDetails){const l=r.response.data.errorDetails.slice(0,10).map(h=>`Row ${h.row}: ${h.error}`).join(`
`);u+=`

`+l}alert(u)}finally{V(!1),v.current&&(v.current.value="")}},I=$.filter(c=>{var y,N,D,S;return((y=c.skuId)==null?void 0:y.toLowerCase().includes(U.toLowerCase()))||((N=c.itemName)==null?void 0:N.toLowerCase().includes(U.toLowerCase()))||((D=c.brand)==null?void 0:D.toLowerCase().includes(U.toLowerCase()))||((S=c.model)==null?void 0:S.toLowerCase().includes(U.toLowerCase()))});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("div",{className:"flex-1 w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",value:U,onChange:c=>Y(c.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>F("/app/sku/create"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Create New SKU"]}),e.jsxs("button",{onClick:E,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",title:"Download Excel template with required columns",children:[e.jsx(pe,{className:"w-5 h-5"}),"Download Template"]}),e.jsxs("button",{onClick:k,disabled:R,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(be,{className:"w-5 h-5"}),R?"Uploading...":"Upload Excel"]}),e.jsx("input",{type:"file",ref:v,onChange:c=>{var y;return i(((y=c.target.files)==null?void 0:y[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),W?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"SKU ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Item Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Product Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Item Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Brand"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Model"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"HSN Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Current Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:I.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"px-4 py-8 text-center text-gray-500",children:"No products found"})}):I.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:c.skuId}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.itemName}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.productCategory||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.itemCategory||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.brand||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.vendor||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.model||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:c.hsnSacCode||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:tt(c.currentStock||0)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>window.location.href=`/app/sku/${c.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>n(c.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},c.id))})]})})})]})})},ht=({transportors:$,loading:W,onRefresh:A})=>{const[F,U]=d.useState(""),[Y,_]=d.useState(!1),[M,R]=d.useState(null),[V,v]=d.useState(!1),[n,k]=d.useState({}),E=d.useRef(null),[i,I]=d.useState({name:"",contactPerson:"",contactNumber:"",email:"",gstNumber:"",isActive:!0,remarks:""}),c=$.filter(r=>{var l,h,s,p,a;const u=F.toLowerCase();return((l=r.name)==null?void 0:l.toLowerCase().includes(u))||((h=r.contactPerson)==null?void 0:h.toLowerCase().includes(u))||((s=r.contactNumber)==null?void 0:s.toLowerCase().includes(u))||((p=r.email)==null?void 0:p.toLowerCase().includes(u))||((a=r.gstNumber)==null?void 0:a.toLowerCase().includes(u))}),y=r=>{r?(R(r),I({name:r.name||"",contactPerson:r.contactPerson||"",contactNumber:r.contactNumber||"",email:r.email||"",gstNumber:r.gstNumber||"",isActive:r.isActive!==!1,remarks:r.remarks||""})):(R(null),I({name:"",contactPerson:"",contactNumber:"",email:"",gstNumber:"",isActive:!0,remarks:""})),k({}),_(!0)},N=()=>{_(!1),R(null),k({})},D=async()=>{var u,l;const r={};if(T(i.name||"")||(r.name="Transporter Name is required"),T(i.contactPerson||"")||(r.contactPerson="Contact Person Name is required"),T(i.contactNumber||"")||(r.contactNumber="Contact Number is required"),T(i.email||"")?Be(i.email||"")||(r.email="Invalid email format"):r.email="Email ID is required",i.gstNumber&&i.gstNumber.trim()&&!Re(i.gstNumber)&&(r.gstNumber="Invalid GST number format"),i.contactNumber&&!$e(i.contactNumber)&&(r.contactNumber="Invalid phone number (10 digits)"),Object.keys(r).length>0){k(r);return}try{v(!0),M?await j.updateTransportor(M.id,i):await j.createTransportor(i),N(),A()}catch(h){alert(((l=(u=h.response)==null?void 0:u.data)==null?void 0:l.error)||"Failed to save transporter")}finally{v(!1)}},S=async r=>{var u,l;if(window.confirm("Are you sure you want to delete this transporter?"))try{v(!0),await j.deleteTransportor(r),A()}catch(h){alert(((l=(u=h.response)==null?void 0:u.data)==null?void 0:l.error)||"Failed to delete transporter")}finally{v(!1)}},H=()=>{const r=[{"Transporter Name":"","Contact Person Name":"","Contact Number":"","Email ID":"","GST Number":"",Status:"Active",Remarks:""}],u=G.book_new(),l=G.json_to_sheet(r);l["!cols"]=[{wch:25},{wch:20},{wch:15},{wch:25},{wch:18},{wch:12},{wch:30}],G.book_append_sheet(u,l,"Transporters Template"),me(u,"Transporter_Upload_Template.xlsx")},L=()=>{var r;(r=E.current)==null||r.click()},b=async r=>{var l,h;if(!r)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(r.type)){alert("Please upload a valid Excel file (.xlsx, .xls) or CSV file");return}try{v(!0);const s=await j.uploadTransportors(r);s.success&&(alert(`${s.message}
Inserted: ${s.inserted}
Errors: ${s.errors}`),A())}catch(s){alert(((h=(l=s.response)==null?void 0:l.data)==null?void 0:h.error)||"Failed to upload file")}finally{v(!1),E.current&&(E.current.value="")}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search transporters...",value:F,onChange:r=>U(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>y(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Add Transporter"]}),e.jsxs("button",{onClick:H,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",title:"Download Excel template with required columns",children:[e.jsx(pe,{className:"w-5 h-5"}),"Download Template"]}),e.jsxs("button",{onClick:L,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"Upload Excel"]}),e.jsx("input",{type:"file",ref:E,onChange:r=>{var u;return b(((u=r.target.files)==null?void 0:u[0])||null)},accept:".xlsx,.xls,.csv",className:"hidden"})]})]}),W?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Transporter Name"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Contact Person"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Contact Number"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Email"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"GST Number"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-gray-500 text-xs",children:"No transporters found"})}):c.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-xs font-medium text-gray-900",children:r.name}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:r.contactPerson||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:r.contactNumber||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:r.email||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:r.gstNumber||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${r.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-3 py-2 text-xs",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S(r.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(he,{className:"w-4 h-4"})})]})})]},r.id))})]})})}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:M?"Edit Transporter":"Add Transporter"}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Transporter Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.name,onChange:r=>I({...i,name:r.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.name?"border-red-500":"border-gray-300"}`}),n.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Person Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.contactPerson,onChange:r=>I({...i,contactPerson:r.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.contactPerson?"border-red-500":"border-gray-300"}`}),n.contactPerson&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.contactPerson})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.contactNumber,onChange:r=>I({...i,contactNumber:r.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.contactNumber?"border-red-500":"border-gray-300"}`}),n.contactNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.contactNumber})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:i.email,onChange:r=>I({...i,email:r.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.email?"border-red-500":"border-gray-300"}`}),n.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.email})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GST Number"}),e.jsx("input",{type:"text",value:i.gstNumber,onChange:r=>I({...i,gstNumber:r.target.value}),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${n.gstNumber?"border-red-500":"border-gray-300"}`}),n.gstNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n.gstNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{value:i.remarks,onChange:r=>I({...i,remarks:r.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:i.isActive!==!1,onChange:r=>I({...i,isActive:r.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700",children:"Status: Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:V,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:V?"Saving...":M?"Update":"Save"})]})]})})})]})},Mt=()=>{const[$,W]=d.useState("category-master"),[A,F]=d.useState({"category-master":!1,products:!1,brands:!1,vendors:!1,customers:!1,teams:!1,transportors:!1}),[U,Y]=d.useState([]),[_,M]=d.useState([]),[R,V]=d.useState([]),[v,n]=d.useState([]),[k,E]=d.useState([]),[i,I]=d.useState([]),[c,y]=d.useState([]),[N,D]=d.useState([]),[S,H]=d.useState([]),L=s=>{W(s),b(s)},b=async(s,p=!1)=>{if(!(A[s]&&!p)&&!(!p&&(s==="vendors"&&U.length>0||s==="brands"&&_.length>0||s==="category-master"&&R.length>0||s==="teams"&&i.length>0||s==="customers"&&c.length>0||s==="products"&&N.length>0||s==="transportors"&&S.length>0)))try{switch(F(a=>({...a,[s]:!0})),s){case"vendors":const a=await j.getYourVendors();Y(a.data||[]);break;case"brands":const x=await j.getYourBrands();M(x.data||[]);break;case"category-master":const[q,B,ee]=await Promise.all([j.getYourProductCategories(),j.getYourItemCategories(),j.getYourSubCategories()]);V(q.data||[]),n(B.data||[]),E(ee.data||[]);break;case"teams":const re=await j.getTeams();I(re.data||[]);break;case"customers":const ye=await j.getCustomers();y(ye.data||[]);break;case"products":const fe=await Ue.getAll({limit:1e4});D(fe.data||[]);break;case"transportors":const Ne=await j.getTransportors();H(Ne.data||[]);break}}catch(a){console.error(`Error loading ${s}:`,a)}finally{F(a=>({...a,[s]:!1}))}},r=async s=>{switch(s){case"vendors":Y([]);break;case"brands":M([]);break;case"category-master":V([]),n([]),E([]);break;case"teams":I([]);break;case"customers":y([]);break;case"products":D([]);break;case"transportors":H([]);break}await b(s,!0)};Je.useEffect(()=>{b($)},[$]);const u=[{key:"category-master",label:"Category Master",description:"Product hierarchy",icon:e.jsx(st,{className:"w-[18px] h-[18px]"})},{key:"products",label:"Products",description:"SKU catalog",icon:e.jsx(at,{className:"w-[18px] h-[18px]"})},{key:"brands",label:"Brands",description:"Brand directory",icon:e.jsx(rt,{className:"w-[18px] h-[18px]"})},{key:"vendors",label:"Vendors",description:"Supplier network",icon:e.jsx(lt,{className:"w-[18px] h-[18px]"})},{key:"customers",label:"Customers",description:"Client database",icon:e.jsx(ot,{className:"w-[18px] h-[18px]"})},{key:"transportors",label:"Transporter Details",description:"Transportation partners",icon:e.jsx(nt,{className:"w-[18px] h-[18px]"})},{key:"teams",label:"Teams",description:"User groups",icon:e.jsx(it,{className:"w-[18px] h-[18px]"})}],l=()=>{const s=u.find(p=>p.key===$);return(s==null?void 0:s.label)||"Library"},h=()=>{switch($){case"category-master":return"Manage product  item  sub-category hierarchy";case"products":return"View and manage your product catalog";case"brands":return"Manage brand information";case"vendors":return"Manage vendor and supplier information";case"customers":return"Manage customer information";case"teams":return"Manage team members and departments";case"transportors":return"Manage transporter and logistics information";default:return""}};return e.jsxs("div",{className:"p-[28.8px] space-y-9 w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-[21.6px]",children:e.jsxs("div",{className:"space-y-[7.2px]",children:[e.jsx("h1",{className:"text-[32.4px] font-black text-slate-900 tracking-tight",children:"Library"}),e.jsx("p",{className:"text-[16.2px] text-slate-500 font-medium",children:"Master data management for vendors, brands, categories, and more."})]})}),e.jsxs("div",{className:"grid grid-cols-12 gap-[21.6px]",children:[e.jsx("div",{className:"col-span-12 lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-[2.25rem] border border-slate-100 shadow-sm p-[21.6px]",children:[e.jsx("h2",{className:"text-[11.7px] font-black text-slate-400 uppercase tracking-[0.2em] mb-[14.4px]",children:"Master Data"}),e.jsx("nav",{className:"space-y-[7.2px]",children:u.map(s=>{const p=$===s.key,a=A[s.key];return e.jsxs("button",{onClick:()=>L(s.key),className:`w-full flex items-center gap-[10.8px] px-[14.4px] py-[10.8px] rounded-[14.4px] text-left transition-all ${p?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"text-slate-700 hover:bg-slate-50"}`,children:[e.jsx("span",{className:p?"text-white":"text-slate-400",children:s.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-[12.6px] font-black ${p?"text-white":"text-slate-900"}`,children:s.label}),e.jsx("div",{className:`text-[10.8px] ${p?"text-indigo-100":"text-slate-500"} font-medium`,children:s.description})]}),a&&e.jsx("div",{className:`w-[14.4px] h-[14.4px] border-2 ${p?"border-white":"border-indigo-600"} border-t-transparent rounded-full animate-spin`})]},s.key)})})]})}),e.jsx("div",{className:"col-span-12 lg:col-span-9",children:e.jsxs("div",{className:"bg-white rounded-[2.25rem] border border-slate-100 shadow-lg",children:[e.jsxs("div",{className:"border-b border-slate-100 px-9 py-[21.6px]",children:[e.jsx("h2",{className:"text-[21.6px] font-black text-slate-900 tracking-tight",children:l()}),e.jsx("p",{className:"text-[14.4px] text-slate-500 font-medium mt-[7.2px]",children:h()})]}),e.jsxs("div",{className:"p-9",children:[$==="category-master"&&e.jsx(xt,{productCategories:R,itemCategories:v,subCategories:k,loading:A["category-master"],onRefresh:()=>r("category-master")}),$==="vendors"&&e.jsx(ct,{vendors:U,loading:A.vendors,onRefresh:()=>r("vendors")}),$==="brands"&&e.jsx(dt,{brands:_,loading:A.brands,onRefresh:()=>r("brands")}),$==="teams"&&e.jsx(ut,{teams:i,loading:A.teams,onRefresh:()=>r("teams")}),$==="customers"&&e.jsx(pt,{customers:c,loading:A.customers,onRefresh:()=>r("customers")}),$==="products"&&e.jsx(gt,{products:N,loading:A.products,onRefresh:()=>r("products")}),$==="transportors"&&e.jsx(ht,{transportors:S,loading:A.transportors,onRefresh:()=>r("transportors")})]})]})})]})]})};export{Mt as default};
